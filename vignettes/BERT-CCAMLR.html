<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Lucy Robinson" />

<meta name="date" content="2018-03-09" />

<title>Using the BERT R package to estimate local toothfish biomass in CCAMLR data-poor areas</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Using the BERT R package to estimate local toothfish biomass in CCAMLR data-poor areas</h1>
<h4 class="author"><em>Lucy Robinson</em></h4>
<h4 class="date"><em>2018-03-09</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This vignette describes the BERT: Biomass Estimation for Research on Toothfish R package. The BERT package was developed to assist CCAMLR’s Working Groups with the estimation of the local biomass of toothfish species in data-poor areas that are progressing towards intergated stock assesments.</p>
<p>The main purpose of this package is to provide functions that:<br />
(1) document the most up-to-date CPUE-by-seabed area and Chapman mark-recapture biomass estimation methods agreed by WG-FSA and WG-SAM and;<br />
(2) format the necessary CCAMLR data for input into the biomass estimation method functions</p>
<p>Methods used to estimate local toothfish biomass in the data-poor CCAMLR fisheries include a CPUE-by-seabed-area analogy method (Agnew et al, 2009) and a Chapman tag-recapture estimator (Hillary et al, 2009). Both methods have undergone modification in the working group meetings over the past 10 years with changes to formulas, fixed parameter values, appropriate time series of catch and tagging data for inclusion and the data quality and cleaning processes applied. To address this issue WG-SAM-16 agreed (and documented) a standardised default method of applying the CPUE-by-seabed area and the Chapman tag release-recapture methods of estimating biomass, and requested that the Secretariat apply these methods to provide a single set of biomass estimates of D. mawsoni or D.eleginoides in Research Blocks in Subareas 58.4 and 48.6 that could be further evaluated by WG-FSA (SC-CAMLR-XXXV, Annex 5, paragraph 2.28).</p>
<p>In this vignette provides examples of both methods that are similar in lay-out to the R-markdown developed by the Secretariat for WG-FSA-17 except instead of using “real data” we provide simulated datasets for Research block 486_3 that targets Antartic toothfish (species_code = TOA) and Research block 5843_a1 that targets Patagonian toothfish (species code= TOP). Given data are simulated there are no data extract and processing steps included here, but see paper WG-FSA-17/42 or the R markdown document referred to above for details on these steps.</p>
<p>To work through the examples in the vignette you will need to install the BERT R package from github. In order to install from github you will firstly need to install devtools (i.e. install.packages(“devtools”)) and then use the following command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;ccamlr/BERT&quot;</span>,<span class="dt">build_vignettes=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="ccamlr-data-required-for-local-toothfish-biomass-estimation" class="section level2">
<h2>CCAMLR data required for local toothfish biomass estimation</h2>
<p>Before stepping though the simulated datasets, a brief explanation of the data that is collected in CCAMLR’s toothfish research programs that are required for local biomass estimation is provided because this is essentially what the simulated data is emulating.</p>
<p>Catch data that are collected for toothfish research, an necessary for local biomass estimation, are recorded and stored in CCAMLR’s database at a haul-by-haul resolution. Each toothfish longline that is set and hauled will have unique id (ID) and information on the set start (SET_START_DATE) and end dates (SET_END_DATE) and haul start (HAUL_START_DATE) and end (HAUL_END_DATE) dates are recorded as well as their geographic positions (e.g. SET_START_LATITUDE,SET_START_LONGITUDE, SET_END_LATITUDE,SET_END_LONGITUDE) and the length of the longline (LINE_LENGTH). The SET_START_DATE is used to generate the CCAMLR fishing season (Season) and the set start and end geographic positions are used to generate a Research Block (RESEARCH_BLOCK_CODE) or Reference Area (REF_AREA_CODE) code. Information on what species were caught (SPECIES_CODE) and their quantities (CAUGHT_KG_TOTAL) on each longline that is set and hauled is also recorded.</p>
<p>CCAMLR’s Scientific Observers will record biological information on a subsample of the hauls for which catch data is recored. The biological data that is relevant to local biomass estimation include the species (SPECIES_CODE), length (LENGTH_CM) and weight of (WEIGHT_KG) of fish from the Subarea or Division (ASD_CODE) that the Research Block is located in. These data are necessary to derive a species and area specific length-weight relationship that can be applied to estimate fish weight from the lengths of fish that are tagged and released.</p>
<p>Observers or crew (depending on the vessel) are also required to tag and release fish (the current tagging rate is 5 fish per tonne in most areas where research is being conducted) and to record information on each fish that is tagged and released and those that are recaptured. Tagged fish release data include information on the SPECIES_CODE, the geographic position of the release (that is used to assign a RESEARCH_BLOCK_CODE and ASD_CODE) and the length of the fish is also measured and recorded (LENGTH_CM). The weight of each released fish is estimated using the length-weight relationships based on the observer data described above Cruise id (CRUISE_ID) and Haul id (HAUL_ID) numbers are also assigned to these release events so they can be matched back to the longline haul they were released from. The estimated weight of the tagged fish releases is added back into the total weight of fish caught for each haul, which is referred to as substantial catch.</p>
<p>If a tagged fish is recaptured, similar information is recorded on the recaptured fish as was recorded on its release. For the purpose of local biomass estimation, necessary data include the CCAMLR fishing season of release (SEASON_RELEASE) and recapture (SEASON_RECAPTURE), the Research Block of release (RESEARCH_BLOCK_RELEASE) and recapture (RESEARCH_BLOCK_RECAPTURE) and the cruise id (CRUISE_ID_RECAPTURE) and set id (SET_ID_RECAPTURE).</p>
<p>Local biomass is estimated annually (i.e. in each CCAMLR fishing season for which data are available), which requires summing data across hauls within a fishing season, but the functions in this R package have been developed to estimate uncertainty around the annual estimates. Uncertainty in both methods is accounted for through bootstrapping the haul data and this is why data are required at a haul-by-haul (rather than an aggeragted annual) resolution.</p>
</div>
<div id="simulated-data" class="section level2">
<h2>Simulated data</h2>
<p>For the CPUE-by-seabed area local biomass estimates catch, length-weight and tagged fish release data from Research blocks and Reference Areas are required while for the Chapman-mark recapture estimates catch, tagged fish release and recapture data from the Research Block are required. The data necessary for both estimates are extracted and provided together. Four datasets were simulated to represent data from Research Block areas similar to what would be provided in CCAMLR data extracts.</p>
<p>Catch data requires the following data fields: ID, Season, CRUISE_ID, SET_ID, SPECIES_CODE, CAUGHT_KG_TOTAL, LINE_LENGTH, RESEARCH_BLOCK_CODE</p>
<p>Simulated catch data for TOA in Research Block 486_3 and TOP in Research Block 5843a_1 included 200 sets per Research Block for the CCAMLR 2017 fishing season. Line lengths were simulated based on a mean of 10 km (or 1000m) and total catch per set was simulated based on means from historical catch from those Research Blocks in the past 3 fishing seasons.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create four simulated datasets similar to what would be provided in data extracts for Research Blocks </span>

catch_data_sim_RB &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">ID=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">200</span>,<span class="dv">1</span>),<span class="dt">Season=</span><span class="kw">rep</span>(<span class="dv">2017</span>,<span class="dv">200</span>),
                                      <span class="dt">CRUISE_ID=</span><span class="kw">rep</span>(<span class="dv">100</span>,<span class="dv">200</span>),
                                      <span class="dt">SET_ID=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">200</span>,<span class="dv">1</span>),
                                      <span class="dt">SPECIES_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;TOA&quot;</span>,<span class="dv">200</span>),
                                      <span class="dt">CAUGHT_KG_TOTAL=</span><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dt">mean=</span><span class="fl">1257.80</span>,<span class="dt">sd=</span><span class="dv">300</span>),
                                      <span class="dt">LINE_LENGTH=</span><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dt">mean=</span><span class="dv">10000</span>,<span class="dt">sd=</span><span class="dv">2000</span>),
                                      <span class="dt">RESEARCH_BLOCK_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;486_3&quot;</span>,<span class="dv">200</span>)),
                           <span class="kw">data.frame</span>(<span class="dt">ID=</span><span class="kw">seq</span>(<span class="dv">201</span>,<span class="dv">400</span>,<span class="dv">1</span>),
                                      <span class="dt">Season=</span><span class="kw">rep</span>(<span class="dv">2017</span>,<span class="dv">200</span>),
                                      <span class="dt">CRUISE_ID=</span><span class="kw">rep</span>(<span class="dv">200</span>,<span class="dv">200</span>),<span class="dt">SET_ID=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">200</span>,<span class="dv">1</span>),
                                      <span class="dt">SPECIES_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;TOP&quot;</span>,<span class="dv">200</span>),
                                      <span class="dt">CAUGHT_KG_TOTAL=</span><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dt">mean=</span><span class="fl">274.93</span>,<span class="dt">sd=</span><span class="dv">50</span>),
                                      <span class="dt">LINE_LENGTH=</span><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dt">mean=</span><span class="dv">10000</span>,<span class="dt">sd=</span><span class="dv">2000</span>),
                                      <span class="dt">RESEARCH_BLOCK_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;5843a_1&quot;</span>,<span class="dv">200</span>)))</code></pre></div>
<p>Release data requires the following data fields: SEASON (of release), CRUISE_ID, SET_ID, SPECIES_CODE,RESEARCH_BLOCK_CODE (of release), ASD_CODE, LENGTH_CM (of the released fish)</p>
<p>Simulated tagged fish release data for TOA in Research Block 486_3 and TOP in Research Block 5843a_1 included 50 released individuals from each CCAMLR 2016 fishing season from 2015 to 2017. Fish lengths were simulated based on mean fish lengths from the tagged fish released in the relevant Research Blocks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># release data </span>
release_data_sim_RB &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">SEASON=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">2015</span>,<span class="dv">50</span>),<span class="kw">rep</span>(<span class="dv">2016</span>,<span class="dv">50</span>),<span class="kw">rep</span>(<span class="dv">2017</span>,<span class="dv">50</span>)),
                                        <span class="dt">CRUISE_ID=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">40</span>,<span class="dv">50</span>),<span class="kw">rep</span>(<span class="dv">90</span>,<span class="dv">50</span>),<span class="kw">rep</span>(<span class="dv">100</span>,<span class="dv">50</span>)),
                                        <span class="dt">SET_ID=</span><span class="kw">sample</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">200</span>,<span class="dv">1</span>),<span class="dv">150</span>,<span class="dt">replace=</span><span class="ot">FALSE</span>),
                                        <span class="dt">SPECIES_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;TOA&quot;</span>,<span class="dv">150</span>),
                                        <span class="dt">RESEARCH_BLOCK_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;486_3&quot;</span>,<span class="dv">150</span>),
                                        <span class="dt">ASD_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;486&quot;</span>,<span class="dv">150</span>),
                                        <span class="dt">LENGTH_CM=</span><span class="kw">rnorm</span>(<span class="dv">150</span>,<span class="dv">150</span>,<span class="dv">10</span>)),
                             <span class="kw">data.frame</span>(<span class="dt">SEASON=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">2015</span>,<span class="dv">50</span>),<span class="kw">rep</span>(<span class="dv">2016</span>,<span class="dv">50</span>),<span class="kw">rep</span>(<span class="dv">2017</span>,<span class="dv">50</span>)),
                                        <span class="dt">CRUISE_ID=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">45</span>,<span class="dv">50</span>),<span class="kw">rep</span>(<span class="dv">95</span>,<span class="dv">50</span>),<span class="kw">rep</span>(<span class="dv">200</span>,<span class="dv">50</span>)),
                                        <span class="dt">SET_ID=</span><span class="kw">sample</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">200</span>,<span class="dv">1</span>),<span class="dv">150</span>,<span class="dt">replace=</span><span class="ot">FALSE</span>),
                                        <span class="dt">SPECIES_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;TOP&quot;</span>,<span class="dv">150</span>),
                                        <span class="dt">RESEARCH_BLOCK_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;5843a_1&quot;</span>,<span class="dv">150</span>),
                                        <span class="dt">ASD_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;5843a&quot;</span>,<span class="dv">150</span>),
                                        <span class="dt">LENGTH_CM=</span><span class="kw">rnorm</span>(<span class="dv">150</span>,<span class="dv">80</span>,<span class="dv">10</span>)))</code></pre></div>
<p>Recapture data requires the following data fields: SEASON_RELEASE, SEASON_RECAPTURE, CRUISE_ID_RECAPTURE, SET_ID_RECAPTURE, SPECIES_CODE_RECAPTURE,RESEARCH_BLOCK_CODE_RECAPTURE, RESEARCH_BLOCK_CODE_RELEASE</p>
<p>Simulated tagged fish recapture data for TOA in Research Block 486_3 included 8 tagged fish recaptures and 4 recaptured individuals from Research Block 5843a_1 from the CCAMLR 2017 fishing season. Note that no within season recaptures were simulated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># recapture data </span>
recapture_data_sim_RB &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">SEASON_RELEASE=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">2015</span>,<span class="dv">2</span>),<span class="kw">rep</span>(<span class="dv">2016</span>,<span class="dv">6</span>)),
                                          <span class="dt">SEASON_RECAPTURE=</span><span class="kw">rep</span>(<span class="dv">2017</span>,<span class="dv">8</span>),
                                          <span class="dt">CRUISE_ID_RECAPTURE=</span><span class="kw">rep</span>(<span class="dv">100</span>,<span class="dv">8</span>),
                                          <span class="dt">SET_ID_RECAPTURE=</span><span class="kw">sample</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">200</span>,<span class="dv">1</span>),<span class="dv">8</span>),
                                          <span class="dt">SPECIES_CODE_RECAPTURE=</span><span class="kw">rep</span>(<span class="st">&quot;TOA&quot;</span>,<span class="dv">8</span>),
                                          <span class="dt">RESEARCH_BLOCK_CODE_RECAPTURE=</span><span class="kw">rep</span>(<span class="st">&quot;486_3&quot;</span>,<span class="dv">8</span>),
                                          <span class="dt">RESEARCH_BLOCK_CODE_RELEASE=</span><span class="kw">rep</span>(<span class="st">&quot;486_3&quot;</span>,<span class="dv">8</span>)),
                               <span class="kw">data.frame</span>(<span class="dt">SEASON_RELEASE=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">2015</span>,<span class="dv">2</span>),<span class="kw">rep</span>(<span class="dv">2016</span>,<span class="dv">2</span>)),
                                          <span class="dt">SEASON_RECAPTURE=</span><span class="kw">rep</span>(<span class="dv">2017</span>,<span class="dv">4</span>),
                                          <span class="dt">CRUISE_ID_RECAPTURE=</span><span class="kw">rep</span>(<span class="dv">200</span>,<span class="dv">4</span>),
                                          <span class="dt">SET_ID_RECAPTURE=</span><span class="kw">sample</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">200</span>,<span class="dv">1</span>),<span class="dv">4</span>),
                                          <span class="dt">SPECIES_CODE_RECAPTURE=</span><span class="kw">rep</span>(<span class="st">&quot;TOP&quot;</span>,<span class="dv">4</span>),
                                          <span class="dt">RESEARCH_BLOCK_CODE_RECAPTURE=</span><span class="kw">rep</span>(<span class="st">&quot;5843a_1&quot;</span>,<span class="dv">4</span>),
                                          <span class="dt">RESEARCH_BLOCK_CODE_RELEASE=</span><span class="kw">rep</span>(<span class="st">&quot;5843a_1&quot;</span>,<span class="dv">4</span>)))</code></pre></div>
<p>Length-weight data requires the following data fields: ASD_CODE,SPECIES_CODE, LENGTH_CM and WEIGHT_KG</p>
<p>Simulated length and weight data TOA in Research Block 486_3 and TOP in Research Block 5843a_1 included 200 individuals per Research Block. Fish lengths were simulated based on mean fish lengths from observer data that had been collected in those Research Blocks. Weights were simulated using approximate parameter values obtained from modelled log-linear relationships between length and weight data collected from these two areas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># length_weight data </span>
length_weight_data_sim_RB &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">ASD_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;486&quot;</span>,<span class="dv">200</span>),
                                              <span class="dt">SPECIES_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;TOA&quot;</span>,<span class="dv">200</span>),
                                              <span class="dt">LENGTH_CM=</span><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dv">150</span>,<span class="dv">50</span>),
                                              <span class="dt">WEIGHT_KG=</span><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dv">40</span>,<span class="dv">10</span>)),
                                   <span class="kw">data.frame</span>(<span class="dt">ASD_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;5843a&quot;</span>,<span class="dv">200</span>),
                                              <span class="dt">SPECIES_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;TOP&quot;</span>,<span class="dv">200</span>),
                                              <span class="dt">LENGTH_CM=</span><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dv">80</span>,<span class="dv">10</span>),
                                              <span class="dt">WEIGHT_KG=</span><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dv">10</span>,<span class="dv">4</span>)))
<span class="co"># add some random error into weight estimates so model fit to simulated data is not perfect</span>
error &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>),<span class="dv">200</span>,<span class="dt">replace=</span><span class="ot">TRUE</span>)
<span class="co"># simulate weight based on length-weight relationship</span>
length_weight_data_sim_RB<span class="op">$</span>WEIGHT_KG &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">12</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span><span class="kw">log</span>(length_weight_data_sim_RB<span class="op">$</span>LENGTH_CM))<span class="op">*</span><span class="fl">1.01</span> <span class="op">+</span><span class="st"> </span>error</code></pre></div>
<p>Three datasets were simulated to represent data from Reference Areas similar to what would be provided in CCAMLR data extracts.</p>
<p>These datasets include catch data, release data and length-weight data. The same data fields were required for these datasets as were required for the Research Blocks except the RESEARCH_BLOCK_CODE field is replaced with REF_AREA_CODE field. For more details on Reference Areas see Working Group paper WG-FSA-17/42</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># catch data</span>
catch_data_sim_RefArea &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">ID=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">400</span>,<span class="dv">1</span>),<span class="dt">Season=</span><span class="kw">rep</span>(<span class="dv">2017</span>,<span class="dv">400</span>),<span class="dt">CRUISE_ID=</span><span class="kw">rep</span>(<span class="dv">70</span>,<span class="dv">400</span>),
                                           <span class="dt">SET_ID=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">400</span>,<span class="dv">1</span>),<span class="dt">SPECIES_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;TOA&quot;</span>,<span class="dv">400</span>),
                                           <span class="dt">CAUGHT_KG_TOTAL=</span><span class="kw">rnorm</span>(<span class="dv">400</span>,<span class="dt">mean=</span><span class="dv">2000</span>,<span class="dt">sd=</span><span class="dv">1000</span>),
                                           <span class="dt">LINE_LENGTH=</span><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dt">mean=</span><span class="dv">10000</span>,<span class="dt">sd=</span><span class="dv">2000</span>),
                                           <span class="dt">REF_AREA_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;RSR&quot;</span>,<span class="dv">400</span>)),
                                <span class="kw">data.frame</span>(<span class="dt">ID=</span><span class="kw">seq</span>(<span class="dv">401</span>,<span class="dv">800</span>,<span class="dv">1</span>),
                                           <span class="dt">Season=</span><span class="kw">rep</span>(<span class="dv">2017</span>,<span class="dv">400</span>),<span class="dt">CRUISE_ID=</span><span class="kw">rep</span>(<span class="dv">80</span>,<span class="dv">400</span>),
                                           <span class="dt">SET_ID=</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">400</span>,<span class="dv">1</span>),<span class="dt">SPECIES_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;TOP&quot;</span>,<span class="dv">400</span>),
                                           <span class="dt">CAUGHT_KG_TOTAL=</span><span class="kw">rnorm</span>(<span class="dv">400</span>,<span class="dt">mean=</span><span class="dv">1530</span>,<span class="dt">sd=</span><span class="dv">800</span>),
                                           <span class="dt">LINE_LENGTH=</span><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dt">mean=</span><span class="dv">10000</span>,<span class="dt">sd=</span><span class="dv">2000</span>)
                                           ,<span class="dt">REF_AREA_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;HIMI&quot;</span>,<span class="dv">400</span>)))

<span class="co"># release data </span>
release_data_sim_RefArea &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">SEASON=</span><span class="kw">rep</span>(<span class="dv">2017</span>,<span class="dv">100</span>),<span class="dt">CRUISE_ID=</span><span class="kw">rep</span>(<span class="dv">70</span>,<span class="dv">100</span>),
                                             <span class="dt">SET_ID=</span><span class="kw">sample</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">400</span>,<span class="dv">1</span>),<span class="dv">100</span>,<span class="dt">replace=</span><span class="ot">FALSE</span>),
                                             <span class="dt">SPECIES_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;TOA&quot;</span>,<span class="dv">100</span>),
                                             <span class="dt">REF_AREA_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;RSR&quot;</span>,<span class="dv">100</span>),
                                             <span class="dt">ASD_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;881&quot;</span>,<span class="dv">100</span>),<span class="dt">LENGTH_CM=</span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">150</span>,<span class="dv">10</span>)),
                                  <span class="kw">data.frame</span>(<span class="dt">SEASON=</span><span class="kw">rep</span>(<span class="dv">2017</span>,<span class="dv">100</span>),<span class="dt">CRUISE_ID=</span><span class="kw">rep</span>(<span class="dv">80</span>,<span class="dv">100</span>),
                                             <span class="dt">SET_ID=</span><span class="kw">sample</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">400</span>,<span class="dv">1</span>),<span class="dv">100</span>,<span class="dt">replace=</span><span class="ot">FALSE</span>),
                                             <span class="dt">SPECIES_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;TOP&quot;</span>,<span class="dv">100</span>),
                                             <span class="dt">REF_AREA_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;HIMI&quot;</span>,<span class="dv">100</span>),
                                             <span class="dt">ASD_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;5852&quot;</span>,<span class="dv">100</span>),
                                             <span class="dt">LENGTH_CM=</span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">80</span>,<span class="dv">10</span>)))


<span class="co"># length_weight data </span>
length_weight_data_sim_RefArea &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">ASD_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;881&quot;</span>,<span class="dv">400</span>),
                                                   <span class="dt">SPECIES_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;TOA&quot;</span>,<span class="dv">400</span>),
                                                   <span class="dt">LENGTH_CM=</span><span class="kw">rnorm</span>(<span class="dv">400</span>,<span class="dv">150</span>,<span class="dv">30</span>),
                                                   <span class="dt">WEIGHT_KG=</span><span class="kw">rnorm</span>(<span class="dv">400</span>,<span class="dv">40</span>,<span class="dv">10</span>)),
                                        <span class="kw">data.frame</span>(<span class="dt">ASD_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;5852&quot;</span>,<span class="dv">400</span>),
                                                   <span class="dt">SPECIES_CODE=</span><span class="kw">rep</span>(<span class="st">&quot;TOP&quot;</span>,<span class="dv">400</span>),
                                                   <span class="dt">LENGTH_CM=</span><span class="kw">rnorm</span>(<span class="dv">400</span>,<span class="dv">80</span>,<span class="dv">10</span>),
                                                   <span class="dt">WEIGHT_KG=</span><span class="kw">rnorm</span>(<span class="dv">400</span>,<span class="dv">10</span>,<span class="dv">4</span>)))
<span class="co"># add some random error into weight estimates so model fit to simulated data is not perfect</span>
error &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>),<span class="dv">400</span>,<span class="dt">replace=</span><span class="ot">TRUE</span>)
<span class="co"># simulate weight based on length-weight relationship</span>
length_weight_data_sim_RefArea<span class="op">$</span>WEIGHT_KG &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">12</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span><span class="kw">log</span>(length_weight_data_sim_RefArea<span class="op">$</span>LENGTH_CM))<span class="op">*</span><span class="fl">1.01</span> <span class="op">+</span><span class="st"> </span>error</code></pre></div>
</div>
<div id="estimating-weight-of-released-tagged-fish-from-observer-length-weight-data" class="section level2">
<h2>Estimating weight of released tagged fish from observer length-weight data</h2>
<p>Fish that are tagged and released are not weighed, but their length is measured. Weights from these released fish are required to estimate the total catch (i.e. not just retained catch) for both the CPUE-by-seabed area and the Chapman mark-recapture biomass estimation methods.</p>
<p>The weights of released fish are estimated using a logliner model, that is parameterised using length and weight data collected by observers on retained catch (i.e. the length-weight data from the ASD that the Research block is situated in is used to parameterise this model). This is done using the est_fish_weight function.</p>
<p>Using the simulated release data and length-weight data from Research Blocks and Reference Areas. The weights of tagged fish releases are estimated and added to the existing data frames as EST_WEIGHT_KG</p>
<p>For input requirements for this function see teh example below and/or ?est_fish_weight</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load BERT package</span>
<span class="kw">library</span>(BERT)

<span class="co"># select length_weight data fields in release data required for input into the est_fish_weight function</span>

data_store_release_RB_input &lt;-<span class="st"> </span><span class="kw">data.frame</span>(release_data_sim_RB<span class="op">$</span>ASD_CODE,release_data_sim_RB<span class="op">$</span>SEASON,
                                          release_data_sim_RB<span class="op">$</span>CRUISE_ID,release_data_sim_RB<span class="op">$</span>SET_ID,
                                          release_data_sim_RB<span class="op">$</span>SPECIES_CODE,release_data_sim_RB<span class="op">$</span>LENGTH_CM)

release_data_sim_RB<span class="op">$</span>EST_WEIGHT_KG &lt;-<span class="st"> </span><span class="kw">est_fish_weight</span>(<span class="dt">length_weight_data =</span> length_weight_data_sim_RB,
                                                     <span class="dt">length_data =</span> data_store_release_RB_input)

<span class="co"># do the same for Reference Area tagged fish releases</span>

data_store_release_RefArea_input &lt;-<span class="st"> </span><span class="kw">data.frame</span>(release_data_sim_RefArea<span class="op">$</span>ASD_CODE,release_data_sim_RefArea<span class="op">$</span>SEASON,
                                               release_data_sim_RefArea<span class="op">$</span>CRUISE_ID,release_data_sim_RefArea<span class="op">$</span>SET_ID,
                                               release_data_sim_RefArea<span class="op">$</span>SPECIES_CODE,release_data_sim_RefArea<span class="op">$</span>LENGTH_CM)

release_data_sim_RefArea<span class="op">$</span>EST_WEIGHT_KG &lt;-<span class="st"> </span><span class="kw">est_fish_weight</span>(<span class="dt">length_weight_data =</span> length_weight_data_sim_RefArea,
                                                          <span class="dt">length_data =</span> data_store_release_RefArea_input)</code></pre></div>
</div>
<div id="cpue-by-seabed-area-biomass-estimation" class="section level2">
<h2>CPUE-by-seabed area biomass estimation</h2>
<p>The point estimation of local biomass using the catch-per-unit-effort (CPUE) by seabed area analogy was agreed at WG-SAM-16; 2.28 and defined as</p>
<p><span class="math display">\[ B_x = \frac{I_x \times A_x \times B_r}{I_r \times Ar} \]</span></p>
<p>Where the subscripts <span class="math inline">\(x\)</span> and <span class="math inline">\(r\)</span> denote the parameter from the research block and reference area respectively. Different reference areas were selected for Research Blocks depending on the target species. WG-SAM-16 agreed that the Ross Sea Region should be used as a reference area for Research Blocks that target D.mawsoni and the HIMI area should be used as a reference area for Research Blocks that target D.eleginoides (WG-SAM-16, para 2.30).</p>
<p><span class="math inline">\(Ix\)</span> is the median of the haul-by-haul CPUE (kg/km) over the past three seasons in which fishing has occurred in Research Block <span class="math inline">\(x\)</span>. For example, if fishing had occurred in Research block <span class="math inline">\(x\)</span> in 2017, 2015 and 2014, then all of these hauls will be included in calculating the median CPUE for the 2017 fishing season.</p>
<p><span class="math inline">\(Ir\)</span> is the median of the haul by haul CPUE (kg/km) over the past three seasons in the relevant Reference Area that relates to the season of the stock assessment that was used to generate the reference area Biomass <span class="math inline">\(r\)</span>. For example if the 2017 assessment was used to generate the reference area biomass then hauls from the 2017,2016 and 2015 seasons would be included</p>
<p>In both <span class="math inline">\(Ix\)</span> and <span class="math inline">\(Ir\)</span> The total fish weight included in the CPUE included the total catch (kg) on a haul, includes fish that were tagged and released (where the weight of released fish is estimated using the length–weight relationship for that area) is divided by the length of line (km) reported for that set (WG-SAM-16, paragraph 2.36).</p>
<p><span class="math inline">\(Ax\)</span> is the seabed area (km2) in Research Block x in the depth range 600–1800 m using a processed version of the GEBCO 2014 dataset.<span class="math inline">\(Ar\)</span> is the seabed area (km2) in the same depth range (i.e. 600-1800m) in the reference area <span class="math inline">\(r\)</span>. Consistent with advice from WG-SAM-17, the seabed area included in the Ross Sea reference area (i.e. RSR_open) only included Small Scale Research Units (SSRUs) that are open to fishing (para 3.11, WG-SAM-17). In the HIMI referemce area <span class="math inline">\(Ar\)</span>=117067.75 km2 and in the RSR_open reference area <span class="math inline">\(Ar\)</span>=120928.75 km2. <span class="math inline">\(Br\)</span> was the current vulnerable biomass (para 3.10 WG-SAM-17) from the 2017 integrated assessments in the Ross Sea, which was estimated to be 92693.07 t of Antarctic toothfish, and the HIMI assessment, which were estimated to be 43993.03 t of Patagonian toothfish. Variation in the reference areas biomass estimates were included with CV values of 0.073 from the Ross Sea Assessment and 0.072 from the HIMI Assessment. Mean and CV values were provided by New Zealand Scientists for the Ross Sea Assessment and Australian Scientists for the HIMI assessment.</p>
<p>The uncertainty around the point estimates was calculated using a non-parameteric bootstrap (Efron and Tibshirani 1993; Chernick 2008). The following steps were applied</p>
<ol style="list-style-type: decimal">
<li>The hauls for the research block and the reference area are sampled with replacement. Noting that if there were zero catch hauls, these are included in bootstrap resampling.<br />
</li>
<li>Median values,<span class="math inline">\(I^i_x\)</span> and <span class="math inline">\(I^i_r\)</span>, calculated for each the ith bootstrap replicates.<br />
</li>
<li>The uncertainty in the reference area biomass was quantified by generating a log normally distributed random number with mean <span class="math inline">\(B_r\)</span> and a standard deviation that is the square root of the coefficient of variation of <span class="math inline">\(B_r\)</span>.<br />
For each ith bootstrap replicate we calculate biomass, as</li>
</ol>
<p><span class="math display">\[ B^i_x = \frac{I^i_x \times A_x \times B^i_r}{I^i_r \times A_r}. \]</span></p>
<p>The areas of the research block and the reference area (<span class="math inline">\(A_x\)</span>,<span class="math inline">\(A_r\)</span>) were assumed to be known without error and are therefore not contributed to the uncertainty in the bootstrap. See ?CPUE_seabed</p>
<p>The uncertainty is then quantified by taking quantiles of the <span class="math inline">\(B^i_x\)</span>, for example, 95% confidence intervals are the 0.025 and 0.975 quantiles.</p>
</div>
<div id="cpue-by-seabed-area-biomass-estimation-of-antarctic-toothfish-toa-in-research-block-486_3" class="section level2">
<h2>CPUE-by-seabed area biomass estimation of Antarctic toothfish (TOA) in Research Block 486_3</h2>
<p>In this example toothfish biomass is estimated using the CPUE-by-seabed area method in 486_3 based on simulated data and the estimated released fish weights described above.</p>
<p>Data from Research block 486_3 are selected</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># use RB as an index </span>
RB &lt;-<span class="st"> &quot;486_3&quot;</span>

<span class="co"># restrict Release data to relevant research block </span>
Release_data_RB &lt;-<span class="st"> </span>release_data_sim_RB[release_data_sim_RB[[<span class="st">&quot;RESEARCH_BLOCK_CODE&quot;</span>]]<span class="op">%in%</span>RB,]

<span class="co"># restrict data to the relevant Research Block    </span>
Catch_data_RB &lt;-<span class="st"> </span>catch_data_sim_RB[catch_data_sim_RB[[<span class="st">&quot;RESEARCH_BLOCK_CODE&quot;</span>]]<span class="op">%in%</span>RB,]</code></pre></div>
<p>Research Blocks where TOP is targetted is specified and the inverse of this infers that TOA is targetted. In this example the target species will be TOA</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># note only 3 Research Blocks currently target TOP and all others target TOA</span>
TOP_target_RBs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5843a_1&quot;</span>,<span class="st">&quot;5844b_1&quot;</span>,<span class="st">&quot;5844b_2&quot;</span>)
## make sure you specifiy target species data 
target_species &lt;-<span class="st"> </span><span class="kw">ifelse</span>(RB<span class="op">%in%</span>TOP_target_RBs,<span class="st">&quot;TOP&quot;</span>,<span class="st">&quot;TOA&quot;</span>)</code></pre></div>
<p>Tagged fish release and catch data in Research Block 486_3 is subset to include only columns of data that are relevant to the CPUE-by-seabed area estimates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># select data for input into biomass estimate function see ?extract_catch_data_cpue_est param release_data</span>
Release_data_RB &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Release_data_RB<span class="op">$</span>SEASON,Release_data_RB<span class="op">$</span>CRUISE_ID,
                              Release_data_RB<span class="op">$</span>SET_ID,Release_data_RB<span class="op">$</span>SPECIES_CODE,Release_data_RB<span class="op">$</span>EST_WEIGHT_KG)

<span class="co"># select data for input into biomass estimate function see ?extract_catch_data_cpue_est param catch_data</span>
Catch_data_RB&lt;-<span class="st"> </span><span class="kw">data.frame</span>(Catch_data_RB<span class="op">$</span>ID,Catch_data_RB<span class="op">$</span>Season,Catch_data_RB<span class="op">$</span>CRUISE_ID,
                           Catch_data_RB<span class="op">$</span>SET_ID,Catch_data_RB<span class="op">$</span>SPECIES_CODE,Catch_data_RB<span class="op">$</span>CAUGHT_KG_TOTAL,
                           Catch_data_RB<span class="op">$</span>LINE_LENGTH)</code></pre></div>
<p>The Reference Areas for a Research Block is based on the species that is being targetted. As outlined in the general methods above the Reference Area for Research Blocks where TOA are targetted is the Ross Sea Region (RSR). Hence if the Research Block does not target TOP, then it targets TOA and the the Ref_area is “RSR”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Ref_area &lt;-<span class="st"> </span><span class="kw">ifelse</span>(RB<span class="op">%in%</span>TOP_target_RBs,<span class="st">&quot;HIMI&quot;</span>,<span class="st">&quot;RSR&quot;</span>)</code></pre></div>
<p>Data from the Relevant Reference Area (i.e. the Ross Sea Region) are selected</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Release_data_RefArea &lt;-<span class="st"> </span>release_data_sim_RefArea[release_data_sim_RefArea[[<span class="st">&quot;REF_AREA_CODE&quot;</span>]]<span class="op">%in%</span>Ref_area,]


Catch_data_RefArea &lt;-<span class="st"> </span>catch_data_sim_RefArea[catch_data_sim_RefArea[[<span class="st">&quot;REF_AREA_CODE&quot;</span>]]<span class="op">%in%</span>Ref_area,]</code></pre></div>
<p>Tagged fish release and catch data from the Reference Area are subset to include only columns that are relevant to the CPUE-by-seabed area estimates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># select data for input into biomass estimate function see ?extract_catch_data_cpue_est param release_data</span>
Release_data_RefArea &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Release_data_RefArea<span class="op">$</span>SEASON,Release_data_RefArea<span class="op">$</span>CRUISE_ID,
                                   Release_data_RefArea<span class="op">$</span>SET_ID,Release_data_RefArea<span class="op">$</span>SPECIES_CODE,
                                   Release_data_RefArea<span class="op">$</span>EST_WEIGHT_KG)

Catch_data_RefArea &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Catch_data_RefArea<span class="op">$</span>ID,Catch_data_RefArea<span class="op">$</span>Season,Catch_data_RefArea<span class="op">$</span>CRUISE_ID,
                                 Catch_data_RefArea<span class="op">$</span>SET_ID,Catch_data_RefArea<span class="op">$</span>SPECIES_CODE,
                                 Catch_data_RefArea<span class="op">$</span>CAUGHT_KG_TOTAL,Catch_data_RefArea<span class="op">$</span>LINE_LENGTH)</code></pre></div>
<p>If the Reference Area is “RSR” then the Reference area biomass (i.e. Ref_area_biomass) is 92693.07 tonnes - as this was the estimated vulnerable biomass from the 2017 stock assessment. The Ref_area_CV from the Ross Sea stock assessement for the vulnerable biomass was 0.073</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 2017 values from WG-FSA-17</span>
Ref_area_biomass &lt;-<span class="kw">ifelse</span>(Ref_area<span class="op">%in%</span><span class="st">&quot;HIMI&quot;</span>,<span class="fl">43993.03</span>,<span class="fl">92693.07</span>)

Ref_area_CVs &lt;-<span class="kw">ifelse</span>(Ref_area<span class="op">%in%</span><span class="st">&quot;HIMI&quot;</span>,<span class="fl">0.072</span>,<span class="fl">0.073</span>)</code></pre></div>
<p>Annual estimates are made for each CCAMLR fishing season for which data are available and all parameter values that are used in calculating biomass are stored with each estimate in store_annual_estimates. Survey_est are the seasons for which catch data were available, which makes estimation of biomass possible. In this example there is only a single year of data included so there is only one annual estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Survey_est&lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(Catch_data_RB<span class="op">$</span>Catch_data_RB.Season))


store_annual_estimates&lt;-<span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="kw">length</span>(Survey_est),<span class="dt">ncol=</span><span class="dv">11</span>))
<span class="kw">names</span>(store_annual_estimates)=<span class="kw">c</span>(<span class="st">&quot;RB&quot;</span>,<span class="st">&quot;Species&quot;</span>,<span class="st">&quot;Season&quot;</span>,<span class="st">&quot;Ref_area&quot;</span>,<span class="st">&quot;RefArea_seabed_area&quot;</span>,
                                <span class="st">&quot;RefArea_N_Hauls&quot;</span>,<span class="st">&quot;RB_seabedarea&quot;</span>,<span class="st">&quot;RB_N_Hauls&quot;</span>,<span class="st">&quot;Est&quot;</span>,<span class="st">&quot;CI_lower&quot;</span>,<span class="st">&quot;CI_upper&quot;</span>)


store_annual_estimates<span class="op">$</span>Season &lt;-<span class="st"> </span>Survey_est</code></pre></div>
<p>In Research Blocks the median CPUE can includes data from the last three seasons in which fishing occured. Depending on the season for which biomass is being estimated (i.e. y) data from all seasons will be included if there are less than three seasons, but if there are more than three seasons of data then this is restricted to the last three years.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (y <span class="cf">in</span> Survey_est){
  
  <span class="co"># select the last three seasons in which fishing occurred </span>
  Seasons &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(Survey_est),y,<span class="dv">1</span>)
  
  <span class="cf">if</span>(<span class="kw">length</span>(Seasons)<span class="op">&gt;</span><span class="dv">3</span>){Seasons &lt;-<span class="st"> </span>Survey_est[(<span class="kw">which</span>(Survey_est<span class="op">%in%</span>y)<span class="op">-</span><span class="dv">2</span>)<span class="op">:</span><span class="kw">which</span>(Survey_est<span class="op">%in%</span>y)]
  }<span class="cf">else</span>{Seasons &lt;-<span class="st"> </span>Survey_est[<span class="dv">1</span><span class="op">:</span><span class="kw">which</span>(Survey_est<span class="op">%in%</span>y)]}
  
}</code></pre></div>
<p>With the relevant seasons to include in Research Blocks specified, the extract_catch_data_cpue_est function uses the catch data and tagged fish release data from Research Blocks to format CPUE data for input into the CPUE_seabed function below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RB_haul_data &lt;-<span class="st"> </span><span class="kw">extract_catch_data_cpue_est</span>(<span class="dt">catch_data=</span>Catch_data_RB,<span class="dt">release_data=</span>Release_data_RB,
                                            <span class="dt">measure =</span><span class="st">&quot;weights&quot;</span>,<span class="dt">target_species =</span> target_species,
                                            <span class="dt">catch_season =</span> Seasons)</code></pre></div>
<p>The first six hauls from the single vector of simulated CPUE values from 486_3 for the 2017 season looks like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(RB_haul_data) 
<span class="co">#&gt; [1]  91.64916 104.89767  53.41912 132.84364 282.82116 160.20095</span></code></pre></div>
<p>The seasons for which CPUE values should be calculated in Reference Areas is specified below. Given the most recent estimated vulnerable biomass in the Reference Areas are from 2017 and the Reference Area is the Ross Sea Region then CPUE values from each haul over the last three seasons (i.e. 2017,2016 and 2015) are included, but given only data from 2017 were simulated then only one seaosns of data is included</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get hauls in last 3 seasons in the Reference Areas that match the latest assessment period</span>
<span class="co"># for HIMI 2017 hauls are excluded because the season and data were considered incomplete, </span>
<span class="co"># but for the simulation we assume complete data in 2017</span>

Ref_area_seasons &lt;-<span class="kw">c</span>(<span class="dv">2015</span>,<span class="dv">2016</span>,<span class="dv">2017</span>)</code></pre></div>
<p>With the relevant seasons to include in the Reference Area specified, the extract_catch_data_cpue_est function uses the simulated catch data and tagged fish release data from the Ross Sea Reference area to format CPUE data for input into the CPUE_seabed function below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RefArea_haul_data_test &lt;-<span class="st"> </span><span class="kw">extract_catch_data_cpue_est</span>(<span class="dt">catch_data=</span>Catch_data_RefArea,
                                                      <span class="dt">release_data=</span>Release_data_RefArea,
                                                      <span class="dt">measure =</span><span class="st">&quot;weights&quot;</span>,
                                                      <span class="dt">target_species =</span> target_species,
                                                      <span class="dt">catch_season =</span> Ref_area_seasons)</code></pre></div>
<p>Fishable seabed area values for a number of Research Blocks are stored in the BERT R package as a two column dataframe called RB_seabed_area. The first column contains the Research Block codes that were used in calculating biomass estimates for WG-FSA-17 and the second column includes the planimetric seabed area values. In the example below the RB_seabed_area parameter value is selected for Research Block 486_3. For further information on this data see ?RB_seabed_area</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># remove survey year col from the matrix for input into tagr multi release function</span>
RB_Seabed_area &lt;-<span class="st"> </span>RB_seabed_area<span class="op">$</span>Seabed_area[RB_seabed_area<span class="op">$</span>RB<span class="op">%in%</span>RB]</code></pre></div>
<p>Fishable seabed area values for Reference Areas are also stored in the BERT R package as a two column dataframe called Ref_area_seabed_area. The first column contains the Reference Area codes that were used in calculating biomass estimates for WG-FSA-17 and the second column includes the planimetric seabed area values for each Research Block. Given it was agreed at WG-SAM-17 the seabed area in the Ross Sea Reference Area should only include those areas that are open to fishing, the “RSR_open” area is selected. For further information on these data see ?Ref_area_seabed_area</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># change Reference area seabed area RSR_open</span>
<span class="cf">if</span>(Ref_area<span class="op">==</span><span class="st">&quot;RSR&quot;</span>){
  RefArea_Seabed_area &lt;-Ref_area_sebed_area<span class="op">$</span>Seabed_area[Ref_area_sebed_area<span class="op">$</span>RefArea<span class="op">%in%</span><span class="st">&quot;RSR_open&quot;</span>]
}<span class="cf">else</span>{
  RefArea_Seabed_area &lt;-Ref_area_sebed_area<span class="op">$</span>Seabed_area[Ref_area_sebed_area<span class="op">$</span>RefArea<span class="op">%in%</span>Ref_area]
}</code></pre></div>
<p>Specify number of bootstrap replicates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of bootstrap replicate samples</span>
n_boot &lt;-<span class="st"> </span><span class="dv">10000</span></code></pre></div>
<p>The point CPUE-by-seabed area biomass estimate of TOA in 486_3 (i.e. Est) for the 2017 season is stored in obj and in summary(CPUE_seabed_boot) the 95% confidence intervals from the boostrapped biomass estimation are also stored in summary(CPUE_seabed_boot). All of these values, along with the parameter input values used in calculating the point estimates are stored in the store_annual_estimates dataframe that is passed to store_biomass_estimates_CPUE</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj &lt;-<span class="st"> </span><span class="kw">CPUE_seabed</span>(<span class="dt">fish_CPUE_data=</span>RB_haul_data,<span class="dt">fish_area=</span>RB_Seabed_area,
                   <span class="dt">ref_CPUE_data=</span>RefArea_haul_data_test,
                   <span class="dt">ref_area=</span>RefArea_Seabed_area,<span class="dt">ref_bio=</span>Ref_area_biomass,<span class="dt">ref_bio_cv =</span> Ref_area_CVs)

CPUE_seabed_boot &lt;-<span class="st"> </span>BERT<span class="op">::</span><span class="kw">bootstrap</span>(obj,n_boot)

store_annual_estimates<span class="op">$</span>RB[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span>RB
store_annual_estimates<span class="op">$</span>Species[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">as.character</span>(target_species)
store_annual_estimates<span class="op">$</span>Ref_area[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span>Ref_area
store_annual_estimates<span class="op">$</span>RefArea_seabed_area[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span>RefArea_Seabed_area
store_annual_estimates<span class="op">$</span>RefArea_biomass[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span>Ref_area_biomass
store_annual_estimates<span class="op">$</span>RefArea_N_Hauls[Survey_est<span class="op">%in%</span>y] &lt;-<span class="kw">length</span>(RefArea_haul_data_test)
store_annual_estimates<span class="op">$</span>RefArea_CPUE[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(obj<span class="op">$</span>data[<span class="st">&quot;ref_CPUE_est&quot;</span>])
store_annual_estimates<span class="op">$</span>RB_seabedarea[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span>RB_Seabed_area
store_annual_estimates<span class="op">$</span>RB_N_Hauls[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">length</span>(RB_haul_data)
store_annual_estimates<span class="op">$</span>RB_CPUE[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(obj<span class="op">$</span>data[<span class="st">&quot;fish_CPUE_est&quot;</span>])
store_annual_estimates<span class="op">$</span>Est[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">summary</span>(CPUE_seabed_boot)[<span class="st">&quot;Est&quot;</span>]
store_annual_estimates<span class="op">$</span>CI_lower[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">summary</span>(CPUE_seabed_boot)[<span class="st">&quot;2.5%&quot;</span>]
store_annual_estimates<span class="op">$</span>CI_upper[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">summary</span>(CPUE_seabed_boot)[<span class="st">&quot;97.5%&quot;</span>]


store_biomass_estimates_CPUE &lt;-<span class="st"> </span><span class="kw">subset</span>(store_annual_estimates,<span class="dt">select=</span> <span class="kw">c</span>(RB,Species,Season,RB_N_Hauls,Est,CI_lower,CI_upper))
store_biomass_estimates_CPUE<span class="op">$</span>Method&lt;-<span class="kw">rep</span>(<span class="st">&quot;CPUE-by-seabed area&quot;</span>,<span class="kw">nrow</span>(store_biomass_estimates_CPUE))</code></pre></div>
</div>
<div id="chapman-mark-recapture-estimator" class="section level2">
<h2>Chapman mark-recapture estimator</h2>
<p>The point estimation of local biomass using the Chapman mark-recapture-based method was agreed at WG-SAM-16; 2.28 and defined as:</p>
<p><span class="math display">\[B_j = \frac{c_j(n_{j-1}+1)}{mx_j+1}\]</span></p>
<p>where <span class="math inline">\(n_{j–1}\)</span> is the number of tagged fish available for recapture at the end of the season prior to season <span class="math inline">\(j\)</span>, <span class="math inline">\(c_j\)</span> is the catch in season <span class="math inline">\(j\)</span> (as with CPUE the catch includes fish that are tagged and released, as these fish are scanned for tags upon capture) and <span class="math inline">\(mx_j\)</span> is the number of tagged fish recaptured in season <span class="math inline">\(j\)</span> (excluding within-season recaptures).</p>
<p>The agreed calculation for the number of tagged fish available for recapture is:</p>
<p><span class="math display">\[
N_j =
\begin{cases}
j=1, r_j(1-t)e^{-(f+M)}-m_j                       
\\
j&gt;1, n_{j-1}
\end{cases}
\]</span></p>
<p><span class="math inline">\(r_j\)</span> is the total number of fish released in CCAMLR fishing season <span class="math inline">\(j\)</span>, <span class="math inline">\(m_j\)</span> is the total number of tagged fish recaptured in CCAMLR fishing season <span class="math inline">\(j\)</span> and <span class="math inline">\(n_{j–1}\)</span> is the number of tagged fish available for recapture at the end of the season prior to season <span class="math inline">\(j\)</span>, <span class="math inline">\(t\)</span> is the post-tagging mortality rate of 0.1 (Agnew 2006), <span class="math inline">\(f\)</span> is the annual tag loss rate which is 0.0084 (WG-SAM-11/18) <span class="math inline">\(M\)</span> is natural mortality where <span class="math inline">\(M\)</span> = 0.13 for Antarctic toothfish (<em>D. mawsoni</em>) (WG-FSA-SAM-06/08) and 0.155 for Patagonian toothfish (<em>D. eleginoides</em>) (Candy 2011).</p>
<p>In the absence of an estimate of movement, the number of tagged fish available for recapture was calculated using a three-year moving window that was applied to release data to account for potential movement-related bias (SC-CAMLR-XXXV/05, paragraph 2.34). However, WG-FSA-17 agreed that only tagged fish that had been at liberty for 1 year should be included in the tagged fish available for recapture estimates in Research Blocks 486_2 and 486_3 (WG-FSA-17, paragraph 4.80). Different functions are called in this R package depending on whether multiple years of tagged fish releases or just a single year of tagged fish releases are included in biomass estimation. When only a single year of tagged fish releases are included in estimates then the single_release function should be used and when multiple years of tagged fish releases are included the multi_release function should be used.</p>
<p>The uncertainty around the point estimates was calculated using a non-parametric bootstrap (Efron and Tibshirani 1993; Chernick 2008). This uncertainty in the estimate is made up of two components. Firstly there is uncertainity in the expected number tagged fish that are available for recapture immediately prior to fishing for the assumed values of tag-induced mortality, tag-loss and natural mortality. In the estimation of this uncertainty, the probability that a tagged fish will survive tagging, natural mortality and not lose its tags is assumed independent from other tagged fish. We undertook the following steps, implementing the probability of each tagged fish surviving the tagging process and the annual natural morality and tag loss as Bernoulli trials (Binomial probabilities).</p>
<ol style="list-style-type: decimal">
<li>Tag release mortality is applied in the season of release</li>
<li>The recaptures are removed and scaled by the tag-reporting rate, noting that tag-reporting rate is currently assumed to be 100%.</li>
<li>Natural mortality and tag loss are implemented</li>
</ol>
<p>Steps 2 and 3 were then repeated for each season that the tags are at liberty, but tag release mortality is only applied in the first season. For the ith bootstrap replicate this represents the <span class="math inline">\(n^i_{j–1}\)</span>. All processes (e.g. tag-induced mortality, natural mortality, tag-loss) were implemented as instantaneous rates to account for processes such as natural mortality and tag-loss that compete with one another to decrease the number of available tags over the season.</p>
<p>Secondly, we need to account for the uncertainty in the haul data. If the experiment was repeated we would not expect to recapture the same number of tagged fish. To account for this uncertainty in the bootstrap the following process is applied</p>
<ol style="list-style-type: decimal">
<li>The hauls in the season were sampled with replacement.Noting that zero tagged-fish recapture and zero catch hauls were included in bootstrapped resampling.</li>
<li>The sum of the catches and the recaptures in the ith bootstrap replicate were calculated as the <span class="math inline">\(c^i_j\)</span> and <span class="math inline">\(mx^i_j\)</span> respectively.</li>
</ol>
<p>Bootstrap replicates of the haul data where there were zero tag recaptures were used to estimate biomass (<span class="math inline">\(B^i_j\)</span>). If the Petersen method had been used the would have been infinite.</p>
<p>For each bootstrap iteration was calculated as:</p>
<p><span class="math display">\[B^i_j = \frac{c^i_j(n^i_{j-1}+1)}{mx^i_j+1}\]</span></p>
<p>The uncertainty was then quantified by taking quantiles of the <span class="math inline">\(B^i_x\)</span>, for example, 95% confidence intervals are the 0.025 and 0.975 quantiles.</p>
<p>Note that in the results the TOA abbreviation for D.mawsoni (TOA) and D.eleginoides (TOP) are used consistently throughout the results below.</p>
</div>
<div id="chapman-mark-recapture-biomass-estimation-of-patagonian-toothfish-top-in-research-block-5843a_1" class="section level2">
<h2>Chapman mark-recapture biomass estimation of Patagonian toothfish (TOP) in Research Block 5843a_1</h2>
<p>In this example toothfish biomass is estimated using the Chapman mark-recapture method in 5843a_1 based on simulated data and the estimated released fish weights described above.</p>
<p>Specify number of bootstrap replicates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of bootstrap replicate samples</span>
n_boot &lt;-<span class="st"> </span><span class="dv">10000</span></code></pre></div>
<p>Remove within season recaptures and recaptures that were released in different research blocks</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### Estimate local biomass using the Chapman mark-recapture method
<span class="co"># remove within season recaptures </span>
recapture_data_sim_RB &lt;-<span class="st"> </span>recapture_data_sim_RB[recapture_data_sim_RB<span class="op">$</span>SEASON_RECAPTURE<span class="op">!=</span>recapture_data_sim_RB<span class="op">$</span>SEASON_RELEASE,]

<span class="co"># recaptures must be from the same research block of release</span>
recapture_data_sim_RB &lt;-<span class="st"> </span>recapture_data_sim_RB[recapture_data_sim_RB<span class="op">$</span>RESEARCH_BLOCK_CODE_RECAPTURE<span class="op">%in%</span>
<span class="st">                                                 </span>recapture_data_sim_RB<span class="op">$</span>RESEARCH_BLOCK_CODE_RELEASE,]

recapture_data_sim_RB &lt;-<span class="st"> </span><span class="kw">droplevels</span>(recapture_data_sim_RB[<span class="op">!</span><span class="kw">is.na</span>(recapture_data_sim_RB<span class="op">$</span>RESEARCH_BLOCK_CODE_RECAPTURE),])</code></pre></div>
<p>Select data from Research Block 5843a_1</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define Research blocks </span>
RB &lt;-<span class="st"> &quot;5843a_1&quot;</span>


Recapture_data &lt;-<span class="st"> </span>recapture_data_sim_RB[recapture_data_sim_RB[[<span class="st">&quot;RESEARCH_BLOCK_CODE_RELEASE&quot;</span>]]<span class="op">%in%</span>RB <span class="op">&amp;</span><span class="st"> </span>recapture_data_sim_RB[[<span class="st">&quot;RESEARCH_BLOCK_CODE_RECAPTURE&quot;</span>]]<span class="op">%in%</span>RB,]

Release_data &lt;-<span class="st"> </span>release_data_sim_RB[release_data_sim_RB[[<span class="st">&quot;RESEARCH_BLOCK_CODE&quot;</span>]]<span class="op">%in%</span>RB,]

Catch_data &lt;-<span class="st"> </span>catch_data_sim_RB[catch_data_sim_RB[[<span class="st">&quot;RESEARCH_BLOCK_CODE&quot;</span>]]<span class="op">%in%</span>RB,]</code></pre></div>
<p>Tagged fish releases, recaptures and catch data for Research Block 5843a_1 are subset to include only fields that are relevant to the Chapman mark-recapture estimates</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Catch_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Catch_data<span class="op">$</span>ID,Catch_data<span class="op">$</span>Season,Catch_data<span class="op">$</span>CRUISE_ID,Catch_data<span class="op">$</span>SET_ID,
                         Catch_data<span class="op">$</span>SPECIES_CODE,Catch_data<span class="op">$</span>CAUGHT_KG_TOTAL)
<span class="kw">names</span>(Catch_data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>,<span class="st">&quot;Season&quot;</span>,<span class="st">&quot;CRUISE_ID&quot;</span>,<span class="st">&quot;SET_ID&quot;</span>,<span class="st">&quot;SPECIES_CODE&quot;</span>,<span class="st">&quot;CAUGHT_KG_TOTAL&quot;</span>)
Release_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Release_data<span class="op">$</span>SEASON,Release_data<span class="op">$</span>CRUISE_ID,Release_data<span class="op">$</span>SET_ID,
                           Release_data<span class="op">$</span>SPECIES_CODE,Release_data<span class="op">$</span>EST_WEIGHT_KG)
<span class="kw">names</span>(Release_data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SEASON&quot;</span>,<span class="st">&quot;CRUISE_ID&quot;</span>,<span class="st">&quot;SET_ID&quot;</span>,<span class="st">&quot;SPECIES_CODE&quot;</span>,<span class="st">&quot;EST_WEIGHT_KG&quot;</span>)
Recapture_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Recapture_data<span class="op">$</span>SEASON_RELEASE,Recapture_data<span class="op">$</span>SEASON_RECAPTURE,
                             Recapture_data<span class="op">$</span>CRUISE_ID_RECAPTURE,Recapture_data<span class="op">$</span>SET_ID_RECAPTURE,
                             Recapture_data<span class="op">$</span>SPECIES_CODE_RECAPTURE)
<span class="kw">names</span>(Recapture_data)&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SEASON_RELEASE&quot;</span>,<span class="st">&quot;SEASON_RECAPTURE&quot;</span>,<span class="st">&quot;CRUISE_ID_RECAPTURE&quot;</span>,<span class="st">&quot;SET_ID_RECAPTURE&quot;</span>,<span class="st">&quot;SPECIES_CODE_RECAPTURE&quot;</span>)</code></pre></div>
<p>Specify the target species. In this example it will be TOP as 5843a_1 is a Research Block where TOP are targetted</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># ensure only data from the relevant RB is included </span>
target_species&lt;-<span class="kw">ifelse</span>(RB<span class="op">%in%</span>TOP_target_RBs,<span class="st">&quot;TOP&quot;</span>,<span class="st">&quot;TOA&quot;</span>)</code></pre></div>
<p>In this example tagged fish recaptures that ahev been at liberty for up to 3 years are included</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(RB<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;486_2&quot;</span>,<span class="st">&quot;486_3&quot;</span>)){
  <span class="co"># for 486_2 and 486_3 WG-FSA-17 agreed tagged fish should only be 1 yr at liberty </span>
  <span class="co"># so only include recaptures from the previous year of release</span>
  Recapture_data &lt;-<span class="st"> </span>Recapture_data[Recapture_data<span class="op">$</span>SEASON_RECAPTURE<span class="op">-</span>Recapture_data<span class="op">$</span>SEASON_RELEASE<span class="op">==</span><span class="dv">1</span>,]
}<span class="cf">else</span>{ <span class="co"># all other RBs recaptures are limited within 3 years of release</span>
  Recapture_data &lt;-<span class="st"> </span>Recapture_data[Recapture_data<span class="op">$</span>SEASON_RECAPTURE<span class="op">-</span>Recapture_data<span class="op">$</span>SEASON_RELEASE<span class="op">&lt;=</span><span class="dv">3</span>,]}</code></pre></div>
<p>Survey years specify the number of years of tagged fish releases to include in the tag release and recapture matrix that is used in the multi_release function that calculates the tagged fish available for recapture</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Survey_years &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(Release_data[[<span class="st">&quot;SEASON&quot;</span>]],<span class="dt">na.rm =</span> <span class="ot">TRUE</span>),<span class="kw">max</span>(Release_data[[<span class="st">&quot;SEASON&quot;</span>]],<span class="dt">na.rm =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>)</code></pre></div>
<p>Release and recapture data are restricted to the target species and subset to include only columns of data that are required for the tag release and recapture matrix that is generated by the extract_recaptures_season function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># for data that is input into tag release and recap matrix  remove non-target species</span>
Releases_input &lt;-Release_data<span class="op">$</span>SEASON[Release_data<span class="op">$</span>SPECIES_CODE<span class="op">%in%</span>target_species]

Recaps_input &lt;-<span class="st"> </span><span class="kw">cbind</span>(Recapture_data<span class="op">$</span>SEASON_RELEASE[Recapture_data<span class="op">$</span>SPECIES_CODE_RECAPTURE<span class="op">%in%</span>target_species],Recapture_data<span class="op">$</span>SEASON_RECAPTURE[Recapture_data<span class="op">$</span>SPECIES_CODE_RECAPTURE<span class="op">%in%</span>target_species])


tag_data_matrix &lt;-<span class="st"> </span><span class="kw">extract_recaptures_season</span>(<span class="dt">release_data =</span> Releases_input,<span class="dt">recapture_data=</span>Recaps_input,                              <span class="dt">release_seasons =</span> Survey_years)</code></pre></div>
<p>The tag release and recapture matrix created looks like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
tag_data_matrix
<span class="co">#&gt;   Year Releases 2015 2016 2017</span>
<span class="co">#&gt; 1 2015       50    0    0    2</span>
<span class="co">#&gt; 2 2016       50    0    0    2</span>
<span class="co">#&gt; 3 2017       50    0    0    0</span></code></pre></div>
<p>The first column includes the season of release, the second column the number of Releases in that season and the following columns are all the years of recaptures. In this example there were there were two recaptures that were released in 2015 and two recaptures that were released in 2016.</p>
<p>Survey est are the seasons for which at least one tagged fish recapture is available. In this example there are only recaptures in 2017</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># No estimates in years where there are zero recaptures </span>
Survey_est&lt;-<span class="st"> </span><span class="kw">unique</span>(Recapture_data<span class="op">$</span>SEASON_RECAPTURE)</code></pre></div>
<p>Annual estimates are made for each CCAMLR fishing season for which tagged fish recapture data are available and all parameter values that are used in calculating biomass are stored with each estimate in store_annual_estimates. For the simulate data example there is only a single year (2017) of tag recapture data included so there is only one annual estimate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">store_annual_estimates&lt;-<span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="kw">length</span>(Survey_est),<span class="dt">ncol=</span><span class="dv">10</span>))
<span class="kw">names</span>(store_annual_estimates)=<span class="kw">c</span>(<span class="st">&quot;Species&quot;</span>,<span class="st">&quot;RB&quot;</span>,<span class="st">&quot;Season&quot;</span>,<span class="st">&quot;N_recaptures&quot;</span>,<span class="st">&quot;Total_Catch&quot;</span>,<span class="st">&quot;RB_N_Hauls&quot;</span>,<span class="st">&quot;Avail_tags&quot;</span>, <span class="st">&quot;Est&quot;</span>,<span class="st">&quot;CI_lower&quot;</span>,<span class="st">&quot;CI_upper&quot;</span>) 

## make sure catch data extracts only include target species data
store_annual_estimates<span class="op">$</span>Species &lt;-<span class="st"> </span><span class="kw">rep</span>(target_species,<span class="kw">length</span>(Survey_est))
store_annual_estimates<span class="op">$</span>RB &lt;-<span class="st"> </span><span class="kw">rep</span>(RB,<span class="kw">length</span>(Survey_est))
store_annual_estimates<span class="op">$</span>Season &lt;-<span class="st"> </span>Survey_est</code></pre></div>
<p>Variable y is the survey year in Survey_est for which tooothfish biomass can be estimated. Depending on whether y is one or more years/seasons from the minimum year of tagged fish release it will need to be adjusted depending on the Research Block. In this example there are three years of tagged fish releases (i.e. 2015,2016 &amp; 2017),and Survey_est is only one year (i.e. 2017). Consequently, the season_releases is not &gt; 3 years so it does not need to be adjusted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (y <span class="cf">in</span> Survey_est){
  
  <span class="co"># if Season releases is &gt; 3 then restrict it to the past three years</span>
  Season_releases &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(Survey_years),y,<span class="dv">1</span>)
  <span class="cf">if</span>(RB<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;486_2&quot;</span>,<span class="st">&quot;486_3&quot;</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">length</span>(Season_releases)<span class="op">&gt;</span><span class="dv">1</span>){
    <span class="co"># 1 years of releases are included as the 1 year prior to the current season (y) </span>
    <span class="co"># are used in calculating the tagged fish available for recapture</span>
    Season_releases &lt;-<span class="st"> </span><span class="kw">seq</span>(y<span class="op">-</span><span class="dv">1</span>,y,<span class="dv">1</span>)}<span class="cf">else</span>{
      <span class="cf">if</span>(<span class="kw">length</span>(Season_releases)<span class="op">&gt;</span><span class="dv">3</span>){
        <span class="co"># 4 years of releases are included as the 3 years prior to the current season (y) </span>
        <span class="co"># are used in calculating the tagged fish available for recapture</span>
        Season_releases &lt;-<span class="st"> </span><span class="kw">seq</span>(y<span class="op">-</span><span class="dv">3</span>,y,<span class="dv">1</span>)
      }
    }
  
}</code></pre></div>
<p>With the relevant season(s) of releases and catch data to include in the Research Block specified, the extract_catch_data_tag_est function uses the catch data and tagged fish release data from Research Blocks to format CPUE data for input into the CPUE_seabed function below. An example of how all the inputs for this function have been formatted are provided above, but for more information see ?extract_catch_data_tag_est</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">haul_data &lt;-<span class="st"> </span><span class="kw">extract_catch_data_tag_est</span>(<span class="dt">catch_data=</span>Catch_data,<span class="dt">release_data=</span>Release_data,
                                        <span class="dt">recapture_data=</span>Recapture_data,<span class="dt">measure=</span><span class="st">&quot;weights&quot;</span>,
                                        <span class="dt">target_species=</span>target_species,<span class="dt">release_seasons =</span>Season_releases,
                                        <span class="dt">catch_season =</span> y)</code></pre></div>
<p>The output haul_data has the CAUGHT_KG_TOTAL of substantial catch (i.e. retained catch + tagged and released fish from catch season y) of each simulated haul in 2017 in the first column and each subsequent column has the number of simulated recaptures in 2017 by the year it was released for each haul. This has been formatted for the multi_release function which provides estimates based on the total number of recaptures irrespective of the release year, but also provides co-hort based estimates using recaptures for each release event. The first six hauls of data from haul_data looks as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">head</span>(haul_data)
<span class="co">#&gt;   CAUGHT_KG_TOTAL 2015 2016 2017</span>
<span class="co">#&gt; 1        361.7356    0    0    0</span>
<span class="co">#&gt; 2        232.6676    0    0    0</span>
<span class="co">#&gt; 3        231.2645    0    0    0</span>
<span class="co">#&gt; 4        330.1367    0    0    0</span>
<span class="co">#&gt; 5        200.1273    0    0    0</span>
<span class="co">#&gt; 6        215.6891    0    0    0</span></code></pre></div>
<p>Because there are very few recaptures per haul this will likely show zero or very few recaptures, but the sum across hauls shows there are two recaptures that were released in 2015 and two recptures that were released in 2016</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colSums</span>(haul_data)
<span class="co">#&gt; CAUGHT_KG_TOTAL            2015            2016            2017 </span>
<span class="co">#&gt;        54069.07            2.00            2.00            0.00</span></code></pre></div>
<p>The matrix of the total number of tagged fish releases and tag recaptures by season (tag_data_matrix) is indexed to include only the relevant seasons of releases and recaptures based on Season_releases</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tags &lt;-<span class="st"> </span>tag_data_matrix[<span class="kw">match</span>(<span class="kw">min</span>(Season_releases),tag_data_matrix<span class="op">$</span>Year)<span class="op">:</span>(<span class="kw">match</span>(<span class="kw">max</span>(Season_releases),tag_data_matrix<span class="op">$</span>Year)<span class="op">-</span><span class="dv">1</span>),]
tags &lt;-<span class="st"> </span>tags[,<span class="kw">names</span>(tags)<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;Releases&quot;</span>,Season_releases)]</code></pre></div>
<p>The multi_release and single_release functions that are used to apply the Chapman mark-recapture biomass estimation method require a list of paramater values and specifications that are passed to these functions in tag_pars. These paramaters include a mean fish weight (mean_wt) which is set to zero as the mean fish weight is not included in the Chapman biomass estimation formula agreed at WG-SAM-16, the method to be used (as a Chapman and Peterson method can be specified), the units of the catch (which in this case is kg), the Ricker type of fishery (which in this case is type 1) and a number of other paramters i.e. natural mortality (nat_mort), tagging mortaility (tag_mort), tag reporting rate (reporting), tag_shedding (chronic_shed) that can vary in relation to the target_species. For further details on paramater values for each species see above and for more detailed explanations of paramters see ?multi_release or ?single_release</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## expanded tag_parameters
<span class="cf">if</span>(target_species<span class="op">%in%</span><span class="st">&quot;TOP&quot;</span>){
tag_pars &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;mean_wt&quot;</span>=<span class="dv">0</span>, <span class="st">&quot;method&quot;</span>=<span class="st">&quot;Chapman&quot;</span>, <span class="st">&quot;unit&quot;</span>=<span class="st">&quot;kg&quot;</span>, <span class="st">&quot;type&quot;</span>=<span class="dv">1</span>,
                   <span class="st">&quot;tag_mort&quot;</span>=<span class="kw">rep</span>(<span class="fl">0.1</span>, <span class="kw">length</span>(Season_releases)), <span class="st">&quot;reporting&quot;</span>=<span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">length</span>(Season_releases)), 
                   <span class="st">&quot;nat_mort&quot;</span>=<span class="kw">rep</span>(<span class="fl">0.155</span>,<span class="kw">length</span>(Season_releases)), <span class="st">&quot;chronic_shed&quot;</span>=<span class="kw">rep</span>(<span class="fl">0.0084</span>,<span class="kw">length</span>(Season_releases)),
                   <span class="st">&quot;chronic_mort&quot;</span>=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(Season_releases)))}<span class="cf">else</span>{
                     tag_pars &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;mean_wt&quot;</span>=<span class="dv">0</span>, <span class="st">&quot;method&quot;</span>=<span class="st">&quot;Chapman&quot;</span>, <span class="st">&quot;unit&quot;</span>=<span class="st">&quot;kg&quot;</span>, <span class="st">&quot;type&quot;</span>=<span class="dv">1</span>,
                                      <span class="st">&quot;tag_mort&quot;</span>=<span class="kw">rep</span>(<span class="fl">0.1</span>, <span class="kw">length</span>(Season_releases)),
                                      <span class="st">&quot;reporting&quot;</span>=<span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">length</span>(Season_releases)), 
                                      <span class="st">&quot;nat_mort&quot;</span>=<span class="kw">rep</span>(<span class="fl">0.13</span>,<span class="kw">length</span>(Season_releases)),
                                      <span class="st">&quot;chronic_shed&quot;</span>=<span class="kw">rep</span>(<span class="fl">0.0084</span>,<span class="kw">length</span>(Season_releases)),
                                      <span class="st">&quot;chronic_mort&quot;</span>=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(Season_releases)))}</code></pre></div>
<p>If more that two release seasons are included then the multi_release function is required and if not then the single_release function is used. In the example from 5843a_1 the multi_release function is used as Season_releases &gt; 2</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="cf">if</span>(<span class="kw">length</span>(Season_releases)<span class="op">&gt;</span><span class="dv">2</span>){
  
  ## now run the model
  obj &lt;-<span class="st"> </span><span class="kw">multi_release</span>(tags, <span class="dt">hauls=</span>haul_data, <span class="dt">pars=</span>tag_pars)
  test_boot &lt;-<span class="st"> </span>tagr<span class="op">::</span><span class="kw">bootstrap</span>(obj,n_boot,<span class="dt">boot_zeros=</span><span class="ot">TRUE</span>)
  
  store_annual_estimates<span class="op">$</span>N_recaptures[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">sum</span>(tags[,<span class="kw">ncol</span>(tags)])
  store_annual_estimates<span class="op">$</span>Avail_tags[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">sum</span>(obj<span class="op">$</span>Avail_tags[,<span class="kw">ncol</span>(obj<span class="op">$</span>Avail_tags)])
  store_annual_estimates<span class="op">$</span>Total_Catch[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">sum</span>(haul_data[,<span class="dv">1</span>])<span class="op">/</span><span class="fl">1e3</span>
  store_annual_estimates<span class="op">$</span>RB_N_Hauls[Survey_est<span class="op">%in%</span>y] &lt;-<span class="kw">nrow</span>(haul_data)   
  store_annual_estimates<span class="op">$</span>Est[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">summary</span>(test_boot)[<span class="st">&quot;Combined&quot;</span>]<span class="op">/</span><span class="fl">1e3</span>
  store_annual_estimates<span class="op">$</span>CI_lower[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">summary</span>(test_boot)[<span class="st">&quot;2.5%&quot;</span>]<span class="op">/</span><span class="fl">1e3</span>  
  store_annual_estimates<span class="op">$</span>CI_upper[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">summary</span>(test_boot)[<span class="st">&quot;97.5%&quot;</span>]<span class="op">/</span><span class="fl">1e3</span> 
  
}<span class="cf">else</span>{
  obj &lt;-<span class="st"> </span><span class="kw">single_release</span>(<span class="dt">tags=</span><span class="kw">as.numeric</span>(tags[<span class="dv">1</span>]), <span class="dt">catch=</span>haul_data[,<span class="dv">1</span>], <span class="dt">recaps=</span>haul_data[,<span class="kw">ncol</span>(haul_data)<span class="op">-</span><span class="dv">1</span>],
                        <span class="dt">method=</span>tag_pars[[<span class="st">&quot;method&quot;</span>]],<span class="dt">unit=</span>tag_pars[[<span class="st">&quot;unit&quot;</span>]],
                        <span class="dt">type=</span>tag_pars[[<span class="st">&quot;type&quot;</span>]],<span class="dt">tag_mort =</span> tag_pars[[<span class="st">&quot;tag_mort&quot;</span>]][<span class="dv">1</span>],
                        <span class="dt">reporting =</span> tag_pars[[<span class="st">&quot;reporting&quot;</span>]][<span class="dv">1</span>],<span class="dt">nat_mort =</span> tag_pars[[<span class="st">&quot;nat_mort&quot;</span>]][<span class="dv">1</span>],
                        <span class="dt">chronic_shed =</span> tag_pars[[<span class="st">&quot;chronic_shed&quot;</span>]][<span class="dv">1</span>],<span class="dt">chronic_mort =</span> tag_pars[[<span class="st">&quot;chronic_mort&quot;</span>]][<span class="dv">1</span>])
  
  test_boot &lt;-<span class="st"> </span>tagr<span class="op">::</span><span class="kw">bootstrap</span>(obj,n_boot,<span class="dt">boot_zeros=</span><span class="ot">TRUE</span>)
  
  store_annual_estimates<span class="op">$</span>N_recaptures[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">sum</span>(haul_data[,<span class="kw">ncol</span>(haul_data)<span class="op">-</span><span class="dv">1</span>])
  store_annual_estimates<span class="op">$</span>Avail_tags[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span>obj<span class="op">$</span>TagsAvailable
  store_annual_estimates<span class="op">$</span>Total_Catch[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">sum</span>(haul_data[,<span class="dv">1</span>])<span class="op">/</span><span class="fl">1e3</span>
  store_annual_estimates<span class="op">$</span>RB_N_Hauls[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">nrow</span>(haul_data)
  store_annual_estimates<span class="op">$</span>Est[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">summary</span>(test_boot)[[<span class="st">&quot;N_hat&quot;</span>]]<span class="op">/</span><span class="fl">1e3</span>
  store_annual_estimates<span class="op">$</span>CI_lower[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">summary</span>(test_boot)[[<span class="st">&quot;2.5%&quot;</span>]]<span class="op">/</span><span class="fl">1e3</span>
  store_annual_estimates<span class="op">$</span>CI_upper[Survey_est<span class="op">%in%</span>y] &lt;-<span class="st"> </span><span class="kw">summary</span>(test_boot)[[<span class="st">&quot;97.5%&quot;</span>]]<span class="op">/</span><span class="fl">1e3</span>
  
}


<span class="co"># store Chapman estimates with inputs</span>

store_biomass_estimates_chapman &lt;-<span class="kw">subset</span>(store_annual_estimates,<span class="dt">select=</span><span class="kw">c</span>(RB,Species,Season,Est,CI_lower,
                                                                         CI_upper,N_recaptures,RB_N_Hauls))
store_biomass_estimates_chapman<span class="op">$</span>Method &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;Chapman&quot;</span>,<span class="kw">nrow</span>(store_biomass_estimates_chapman))</code></pre></div>
<p>To present results in both table form and plots we combined the dataframes that stored the CPUE-by-seabed area estimates with the Chapman mark-recapture estimates. While the worked examples provided above only included a CPUE-by-seabed area estimate for 486_3 and Chapman mark-recapture biomass estimate for 5843a_1, both biomass estimates were made for both Research blocks for completeness and comparison in the results below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
store_B_est_all &lt;-<span class="st"> </span><span class="kw">rbind</span>(store_biomass_estimates_chapman,<span class="kw">data.frame</span>(store_biomass_estimates_CPUE,<span class="dt">N_recaptures=</span><span class="kw">rep</span>(<span class="ot">NA</span>,<span class="kw">nrow</span>(store_biomass_estimates_CPUE))))</code></pre></div>
<div id="section" class="section level5">
<h5></h5>
</div>
</div>
<div id="example-presentation-of-biomass-estimates" class="section level1">
<h1>Example presentation of biomass estimates</h1>
<p>Point biomass estimates from both methods with upper and lower confidence intervals are shown in the table below</p>
<table>
<colgroup>
<col width="9%"></col>
<col width="9%"></col>
<col width="8%"></col>
<col width="7%"></col>
<col width="10%"></col>
<col width="10%"></col>
<col width="14%"></col>
<col width="20%"></col>
<col width="10%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">RB</th>
<th align="left">Species</th>
<th align="left">Season</th>
<th align="left">Est</th>
<th align="left">CI_lower</th>
<th align="left">CI_upper</th>
<th align="left">N_recaptures</th>
<th align="left">Method</th>
<th align="left">Catch_lim</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">486_3</td>
<td align="left">TOA</td>
<td align="left">2017</td>
<td align="left">1490</td>
<td align="left">834.1</td>
<td align="left">3612</td>
<td align="left">6</td>
<td align="left">Chapman</td>
<td align="left">59.62</td>
</tr>
<tr class="even">
<td align="left">486_3</td>
<td align="left">TOA</td>
<td align="left">2017</td>
<td align="left">472.3</td>
<td align="left">394.7</td>
<td align="left">548.6</td>
<td align="left">NA</td>
<td align="left">CPUE-by-seabed area</td>
<td align="left">18.89</td>
</tr>
<tr class="odd">
<td align="left">5843a_1</td>
<td align="left">TOP</td>
<td align="left">2017</td>
<td align="left">779.2</td>
<td align="left">410.1</td>
<td align="left">1996</td>
<td align="left">4</td>
<td align="left">Chapman</td>
<td align="left">31.17</td>
</tr>
<tr class="even">
<td align="left">5843a_1</td>
<td align="left">TOP</td>
<td align="left">2017</td>
<td align="left">1341</td>
<td align="left">1132</td>
<td align="left">1553</td>
<td align="left">NA</td>
<td align="left">CPUE-by-seabed area</td>
<td align="left">53.64</td>
</tr>
</tbody>
</table>
<div id="compare-biomass-estimates-with-confidence-intervals-using-the-two-different-methods" class="section level2">
<h2>Compare biomass estimates with confidence intervals using the two different methods</h2>
<p>A plot of the point biomass estimates with confidence intervals in each Research Blocks is also provided for visual comparison.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAYAAABFmt0fAAAEGWlDQ1BrQ0dDb2xvclNwYWNlR2VuZXJpY1JHQgAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VQNcC+8AAEAASURBVHgB7d0HmBRVtsDxM+ScwyBZQBGQKAM8FGEFAckqKqCuZGVFEAmiohKMKBgXhDULDxBFQEAwwJIkqKwsWZacM0NOM6/P9VVvzzDddMNMTXXV/37f0F353l8NPadv3RCT6EtCQgABBBBAAAEEPCSQwUNlpagIIIAAAggggIARIADiFwEBBBBAAAEEPCdAAOS5W06BEUAAAQQQQIAAiN8BBBBAAAEEEPCcAAGQ5245BUYAAQQQQAABAiB+BxBAAAEEEEDAcwKZPFdiX4F37dolFy5c8GLRKTMCUSGQIUMGKV26tKPzunXrVkfnj8wh4HWBHDlySNGiRYMyeDIAOnnypJw7dy4oChsQQCB9BTJmzJi+GQjj6vHx8WHsxS4IIOBUAR6BOfXOkC8EEEAAAQQQSDMBAqA0o+XECCCAAAIIIOBUAQIgp94Z8oUAAggggAACaSZAAJRmtJwYAQQQQAABBJwqQADk1DtDvhBAAAEEEEAgzQQIgNKMlhMjgAACCCCAgFMFPNkN3qk3g3z9KfDHH3+YNxUqVPCT6Jgre/bskdq1a0uWLFn863U4g19//VViYmLklltukcyZM/u3BXtz9uxZWblypegYEdWrV5do6HIdrCysR8CLAr///nuSoUz0syJ//vyG4vjx4/Lbb7/JzTffLIUKFbqMR4dB0e0NGjTwbzt48KD861//Ej1PmTJl/Ouv5c3GjRslW7Zsjh/P6lrKGO3HZnzRl6K9EJHm/9ChQ3Lp0qVID2N/GwT0w6tPnz6SM2dOqVatmrniG2+8If/85z/NPXvrrbekXr16kjt3bjlz5oz07t3bvO7evVs++OADadmyZciARu99z549zfmXL18uP/30k9xxxx02lIxLRCKgAyEWKVIkkkNs33f//v22X5MLily8eFG6d+8uOg6TBhn6o0GL/r78/PPPMnz4cMmXL598+umnkpCQIBUrVkzCNnLkSFm4cKG0bt3arJ8zZ4689957/mOyZs1qAqEkB0W4sH37dhkwYIDJV/ny5SM8mt1TS0DvpRUYp3ROaoBSUmFdugm8+eabUqBAAf/1NSBatGiRfPnll6bmR2trZs2aZT4Av/32W7nxxhulf//+Zv/PP//cfBjqN79gaf78+dK2bVu5//77TUDVvn172bFjh5QqVSrYIaxHAAEHCWhwUbx4cRkxYsRluZo2bZp069ZNbrvtNvMzdOhQadOmjX+/H374QXbu3OlfTkxMFF333HPPmZoa/ewYM2aMNG/e3L/P0aNHRX9iY2NNrbF/Q5A3+rmkn0V58uQJsgernSJAAOSUO0E+ZPbs2SZaL1GihF8jV65c5rGWPuaqVKmSrFu3zl91/csvv0irVq1kxYoVJpjp1KmTaM1BqKQBj5W0yltrAlOqJrf24RUBBJwlsHnzZhMAff/99+YxmNbgZs+e3WSyWLFiop8LtWrVMo+5A2sRtcZuypQp8uijj5ogRw/QR+f6pUuTTo+kNUjWFCz62aAB1IEDB0wwozVNTz/9tKmBNgcE+Ucfe2kQ9fe//92cP8hurHaAAAGQA24CWRDRR1jTp08XfcSl356spDU+Tz75pAwZMsTUAGl1cosWLcxmfZylH2iFCxc2H176CEw/eKwPQ+scKb3qt8cFCxaYmiRtC0RCAIHoENAAaNOmTaaNz7Zt2+Sjjz6S8ePHS8GCBeWRRx6Rxx57TDQ40uBGgxBN+ijs9ddfl8cffzxJG0KrxPo4rXPnzqLtA61jtKZJH8WPHTvW7DZ58mRzXn0EHyo1btzYv1lrmEjOFQj9ddm5+SZnLhLQb1qvvfaaafuTPHjRD7tRo0bJuHHj5KuvvpKyZcuKPsPXpMdpQKTB0bBhw8w3N31cFk7SKu/PPvvMPE7T9gAkBBCIDoEuXbqYgOfuu++Wfv36mY4R8+bNM5nXZX28PWPGDHnmmWekb9++po2gflHSx+VVq1ZNsZD6uGrq1Kmmhudvf/ubOeb6668359LH76+88oroo63z58+neDwro1OAACg675urcq3ftDZs2CCDBg0yj7S+/vprmThxoqkNWr16tdSpU0f0w0iDo3vvvddUbSuA1vzcdNNNfgsNhvQ8odL69evlyJEjZpfrrrvOtBPQx2skBBCIDgGtLQ6czFrb7+3bt0+0Rvjw4cOmcXOmTJmkfv365jNCH13NnTvXBEX6yFzbDGrNkT4O14BGH6Fr0hojbTukDaj1c0IfkQ8cONBsa9eunQmGzAL/uEaAR2CuuZXRWxANbqxvcFoKre3RYOehhx6SXbt2mVoa7fGl67T7ugZEmm699VZ/Ly7tGbJ06VK57777zLZg/2j7AH2m/9RTT5nqbv3w0w9FEgIIRIfA4sWLRbutay+r06dPm0fZ2q5H2/LplxodRkN7fmmbH228rF+SPv74Y3/h9EuStvvRx2b6iEpfte2gDqOhj9Y0iNKgSj+TatasaQIlfYSmX8r0c4bkHgECIPfcS1eWRBtEN2vWzFRNayNFrfXRLrCa7rrrLlPjo1Xi+k2ubt260qhRo5AO+k1OP/z0A1Mfoem3RKtNUcgD2YgAAo4Q0Edf+lhch7PQQEgbQdeoUcPkrVevXqb7+6lTp0y7H23zo12hgyWt9dGhNP7xj3/Ihx9+aPbVR+oaTGlbnueff948RtPPHh2WQ4MvknsEYnwRsOdaaek3gMAqVPfcTveWRH9NtRYopQbLul4/yLT3RbhJj9EPxiv1Ggv3fOyXugLa+L1KlSqpe9JUPpsOxkdKPwH9P6y/J4EDo1q50QBIGzBHknSARO11mjzpUBzaRkg/Y0jRJaD3TduNBkvUAAWTYb2jBPTDJ6XgRzMZ2HBae3No766Uko4dot1jNQUek9K+rEMAAWcLhPo/HGnwoyVNKfjR9Xnz5tUXf9LBUzVYSp70M4rH6clVnL1MAOTs+0PuIhTQGh1txJhSChZApbQv6xBAAIGUBHQUem1kTYp+Ae5i9N9DShAgoN/iAuf4CdjEWwQQQOCaBXQ+QpI7BOgG7477SCkQQAABBBBAIAIBAqAIsNgVAQQQQAABBNwh4MlHYDpfjHaBJrlDIHPmzKaHBqO0uuN+aimioXdeyZIl3QNOSUyvUP27wFg/7vllSKmHYGDpPBkAaRd4AqDAX4Pofq+9QfQP5okTJ6K7IOTeLxANXY4ZSsN/u1zxRnt76cCK3FdX3M6wCsEjsLCY2AkBBBBAAAEE3CRAAOSmu0lZEEAAAQQQQCAsAQKgsJjYCQEEEEAAAQTcJEAA5Ka7SVkQQAABBBBAICwBAqCwmNgJAQQQQAABBNwkQADkprtJWRBAAAEEEEAgLAECoLCY2AkBBBBAAAEE3CRAAOSmu0lZEPCYwObNm2X+/Ply5syZJCXXsVyWLFkiS5culQsXLiTZtnHjRpk3b54cOnQoyfpQxyTZkQUEEHCFQEyiL7miJBEU4sCBAwyEGIGX03fV2d91IMQjR444PavkL0wBHQgxNjY25N79+vWTjBkzSrly5UwQ9NRTT0lcXJwJhrp06SKVK1eWPXv2mBF+R40aZUYLHz16tKxdu1YqVKhggqN3331XSpUqFfKYYJnYu3dvsE2sj0KBIkWKmIEQT548GYW5J8spCWTNmlUKFCiQ0iazzpMjQQfVYAMCCESFwJo1a+TgwYPy+eefm/zeeOONMmnSJBMATZ48WerUqSN9+/Y123r27CnLly83AdWiRYtk6tSpJmDW/SdMmCCDBw+WYMfUrVs3KjzIJAIIRC5AABS5GUcggEA6C1SqVEnGjRvnz8Xx48fl7NmzZlkfi915553+bTVr1pR169aZb/dVq1b1zzOm62fNmhXymMAASAOmbdu2mf1z5swpnTt39l+DN9EvoLWOWmMQDdOwRL+2PSVISEgIeSECoJA83t3417/+1fzRiFRA21vo4yh9NBFp0kcYDzzwQKSHsb8HBfR3TOeA06SPtLUmaMCAAWZ53759kidPHvNe/9H3u3btMn/cdL4nK+n6w4cPm8Vgx1j76usvv/wiv/32m1mlj10fe+yxwM28TyagkxNXrFgx2dorL2qrDJ2QVD9D9D5HmmbOnGkef0Z6nAY+mTJluqprRnot9rdH4ErzuhEA2XMfou4qDRo0kPLly0ec788++0xuuOEGCfzmHO5Jrr/++nB3ZT8EjMDWrVtl0KBBpjbG+p3TP5yBkx3rH1MNloKt1xOF2mZRv/HGG9Zb80oboCQcly3oPWjZsuVl66+0Ij4+3jyavOuuu6R06dJX2v2y7fqtXx+PRppoAxSpmPP31xo9ra0NlgiAgsl4fH3Xrl2vSuCbb76R//mf/5Fnn332qo7nIATCFVi/fr1pv/Pkk0/K7bff7j+sUKFCSRrEa+P4kiVLitb+rF692r+fri9WrJhZDnaMf2feRCygQeWQIUMiPm7nzp0mANLa4MaNG0d8PAcgEK5A5PWL4Z6Z/RBAAIE0EtAu7AMHDpQXXnghSfCjl7vttttkzpw5pk2Q7qdd4WvUqCG1a9cWbTytf2C1VkgflWivsVDHmI38gwACrhSgBsiVt5VCIeBugSlTpsixY8ekT58+/oJqd1etgdRaAx0DqEOHDqY9h9YklC1b1uzXo0cP6datm+kaq49XOnbsaNaHOsZ/Ad4ggICrBAiAXHU7KQwC3hDo1auX6E9KSRuyDh8+XE6cOGHa/uiylbRNStOmTUUbR+bKlctabRq/BjvGvxNvEEDAVQL//WRwVbEoDAIIeF0gd+7cKRJkzpxZ9CelFOyYlPZlHQIIRLcAbYCi+/6RewQQQAABBBC4CgECoKtA4xAEEEAAAQQQiG4BTz4Cu5rBtaL7Ntubex1QTLvA2pX0enZf066yefU6ej9JCCCAQFoKeDIAypIli61/oNPyBjrt3PqHS9tXhBp8KrXzrI1c9bp2XjO1y8D5kgpcaQj7pHuzhAACCEQu4MkASOcMChwpNnI2jggmoMPY6xD4OpqrXcmaDd7Oa9pVNq9eRwNaGiR79e5TbgTsEaANkD3OXAUBBBBAAAEEHCRAAOSgm0FWEEAAAQQQQMAeAQIge5y5CgIIIIAAAgg4SIAAyEE3g6wggAACCCCAgD0CBED2OHMVBBBAAAEEEHCQAAGQg24GWUEAAQQQQAABewQIgOxx5ioIIIAAAggg4CABAiAH3QyyggACCCCAAAL2CBAA2ePMVRBAAAEEEEDAQQIEQA66GWQFAQQQQAABBOwRIACyx5mrIIAAAggggICDBAiAHHQzyAoCCCCAAAII2CNAAGSPM1dBAAEEEEAAAQcJEAA56GaQFQQQQAABBBCwR4AAyB5nroIAAggggAACDhIgAHLQzSArCCCAAAIIIGCPAAGQPc5cBQEEEEAAAQQcJEAA5KCbQVYQQAABBBBAwB4BAiB7nLkKAggggAACCDhIgADIQTeDrCCAAAIIIICAPQIEQPY4cxUEEEAAAQQQcJAAAZCDbgZZQQABBBBAAAF7BAiA7HHmKggggAACCCDgIAECIAfdDLKCAAIIIIAAAvYIEADZ48xVEEAAAQQQQMBBAgRADroZZAUBBBBAAAEE7BEgALLHmasggAACCCCAgIMECIAcdDPICgIIIIAAAgjYI0AAZI8zV0EAAQQQQAABBwkQADnoZpAVBBBAAAEEELBHIJM9l+EqCCCAgLsE8uTJ464COaQ0uXLlMjnJkSOH2GkcExMjWbNmlQwZqBdwyK/CNWcjISEh5DkIgELysBEBBBBIWeDkyZMpb2DtNQmcOnXKHH/mzBmx0zhbtmxy/vx5sa5/TYXgYEcIZM6cOWQ+CIBC8rARAQQQSFngSt8uUz6KtVcSSExMNLvoq93G6XHNK3mwPe0EqOtLO1vOjAACCCCAAAIOFSAAcuiNIVsIIIAAAgggkHYCBEBpZ8uZEUAAAQQQQMChAukWAB04cEC+++472bp162U0GzdulHnz5smhQ4eSbNPluXPnim5PnoIdk3w/lhFAAAEEEEAAgXQJgL799lsZMGCA7Nq1S5577jmZNWuW/06MHj1aRo4cKatWrZKuXbvKjh07zDZd7ty5s2zatEkGDhwo06ZNu+Ix/h14gwACCCCAAAIIBAjY3gtMW9lr7c7QoUOlTJkyUq1aNXn33XelRYsWsm3bNlm0aJFMnTrVjMUwadIkmTBhggwePFjeeustGTFihNn/vvvuk27duplj9uzZE/SYgHLyFgEEEEAAAQQQ8AvYHgDpYFPvvPOOycCFCxdkyZIlJhDSFVu2bJGqVav6B6KqWbOmqR26ePGiqS3SbZqKFi0qOkjW7t27zSO0lI4xO/7/PytWrJDly5f7V7Vu3VoKFCjgX+ZN6gno/dWxF6zBzFLvzMHPlClTJtHr2nnN4LlhS2oIWF2hU+NcnAMBBBBIScD2AMjKRHx8vHTq1El0sKvx48eb1Xv37pW8efNau5hRQA8fPizaXihnzpzmj5y1Ufc7cuSIBDvG2k9fV69ebWqSrHXNmjUz57OWeU09AQ1EsmTJYquvXlOT/o6Q3CFw6dIldxSEUiCAgGMF0i0A0iHOZ8yYIQsXLpSePXvK9OnTJWPGjBL4wac1P9mzZ79svWrqNh25M9gxgeL6uEx/rKQB1f79+61FXlNRQAcu05FU7fTNly+fqTXUgJjkDgENamNjY91RGEqBAAKOFLC9EbQONb5s2TKDoR9yt99+u+gfsLVr10rhwoVNrY4lpX/QihUrJgULFjR/VM+dO2dtMvtdd911QY/x78gbBBBAAAEEEEAgmYDtAZC2Dxk7dqxouxxN2n1dH3OVLl1aateuLWvWrJGdO3eaGp6ZM2dKXFycaBuPOnXqmBojPUZrjfLnz29+gh2j+5EQQAABBBBAAIGUBGx/BKa1Pn379jVB0Lhx48zsu9ojTGt/NPXo0cM8rtJGyhoUdezY0azv1auXv/u7ztb7/PPPm/X6KC3YMWYH/kEAAQQQQAABBJIJ2B4A6fWrV69uAiCd6Td5z52WLVtK06ZNRR93BW7TYGjy5Mly7Ngx88gssBzBjgnch/cIIIAAAggggIAlkC4BkHXxwADHWqev+pgs2DT22l4opRTqmJT2Zx0CCCCAAAIIeFfA9jZA3qWm5AgggAACCCDgFAECIKfcCfKBAAIIIIAAArYJEADZRs2FEEAAAQQQQMApAgRATrkT5AMBBBBAAAEEbBMgALKNmgshgAACCCCAgFMECICccifIBwIIIIAAAgjYJkAAZBs1F0IAAQQQQAABpwgQADnlTpAPBBBAAAEEELBNIKKBEBMTE2XHjh2ybt06yZs3rxnROUeOHLZllgshgAACCCCAAAKpIRBWDdCvv/4qzZs3F513q0yZMtKiRQupX7++Wa5SpYqZi2vr1q2pkR/OgQACCCCAAAIIpLlAyABo+/bt0qlTJ3n44YfNTO3ffvutaKCj83QdOXJEFi1aJE899ZRozVDNmjVl8ODBcuLEiTTPNBdAAAEEEEAAAQSuRSBoAJSQkCD333+/CX7Wrl0rw4YNk9tvv93UAOm8W/nz55d69epJ586dZfz48bJhwwbRmd67det2LfnhWAQQQAABBBBAIM0FgrYBypAhgyxdulT0NZxUtGhRefnll+XSpUvh7M4+CCCAAAIIIIBAugmEjG4Cg58mTZrIyZMnL8voJ598Ih07dvSvz5gxo/89bxBAAAEEEEAAAScKBK0B0swuX75cvv/+e5PvxYsXy6uvvirZsmXzl0Nre7755hupUKGCfx1vEEAAAQQQQAABpwuEDIDKly8v/fr1M42eL1y4ILNmzZLAGh5tC6S9wp555hmnl5P8IYAAAggggAACfoGQAVDBggVlyZIlZufWrVvLxIkTJVeuXP6DeYMAAggggIDXBVatWiWbN2+2laFUqVJSp04dW6/ptouFDIB2794txYsXN2WeMWNGWGXfsmWLXH/99WHty04IIIAAAghEu8CUKVPk008/tbUYd999NwHQNYoHDYB0bJ+2bdtK06ZNpXfv3qK9vIIl3VfHCHrttdfk5ptvljFjxgTblfUIIIAAAgi4SuDFF1+UZ599NuIy9erVy3Qu+uyzzyI+NlOmoH++Iz6XVw8IKqhj+ixbtkz+8Y9/mEEOb7jhBrnjjjtEq91Kliwp8fHxZuwfHf/n559/NmMAjRo1yowY7VVMyo0AAggg4D2BrFmziv5EmjSI0Xa1NC2JVC519g8aAOnp9cb07NnTjAb97rvvmpGfddBDnQ9Me4NpbU+tWrVM5NuhQwchIk2dm8JZEEAAAQQQQCBtBUIGQNalNTrVaS70R5OOB6QBEAGPJcQrAggggAACCESTQMiBEAMLolNjfPfdd3L+/HlTXffWW29JmzZt5OOPPw7cjfcIIICArQL6GH7btm1Jrqm9cvQRvvWjcxdaaePGjTJv3jw5dOiQtcq86hyH2utVR8DXYT9ICCDgboGwAyBt4NWyZUvZu3ev6Q7/9NNPG5knnnhCJk+e7G4lSocAAo4U0MmZdULm9evX+/N38eJFGTBggEybNs3/oz1aNY0ePVpGjhwpGiB17drVPM7X9WfOnJFHHnlE5s+fL1988YUMHDjQTPKs20gIIOBOgbAegWnRtWfX7NmzpXTp0vLoo49KixYtZPr06eYDZdKkSWbiVHcSUSoEEHCigH7+aA103rx5k2RPa4NKlChheqUGbtD1ixYtkqlTp5o5DvVza8KECebRvn6J0zFV+vbtaw7Rto86En7dunUDT8F7BBBwkUBYAZBWH584cUIaNmxoviktWLDA39W9XLly8vXXX7uIhKIggEA0CGTPnl0+/PBDeeedd0wvVCvPf/zxhwmA9JG9PtbSeQxz5MghOkZZ1apV/RM816xZ04xur8fpIHZ33nmndQrT83XdunVJAiDt7Wo9NtMeP7Vr1/bvz5vUE7B6U2XJkiXJ1Eupd4WUz6Q9n7Vda+B0TynvmXprdb5N/bHzmqmXe+efKXA+05RyG1YAlD9/fvMBot+e9BGYtgNq1qyZaFWzfnNq1KhRSudmHQIIIJBmAoEBi45FZqVNmzaJtvOpVq2a6CMy7bmqkzbrZ1dgbVGePHnk8OHD5rB9+/aJLltJ3+/atctaNK8ffPCBGfJDF/QzUdsXkVJf4Pjx4+ak2vlGne1MGlTrj11JgzydUsructpVvvS+zunTp0NmIawASCNjbQOkgyJqY2gdGDE2NtYMlKjVxIMGDQp5ETYigAACdgl0795d9EdrfTRpLZDWBum3e53A2Ur6Bc76Y6dDfgTbZu3//vvvmy99uqzfLDVoIqW+wMGDB81Jjx49aqtx4cKFzRMO7eVsVzp79qz5/eR3KW3ENcC0PgdSukJYAZAeqI2emzdvLnrD4uLizLn69Olj3ufMmTOlc7MOAQQQsF1AGzwXKlTI/8Gng7dq7Y8+8lq9erU/P/pov1ixYmZZ9w/sKabvdcDXwJT8c87OP5SB+XD7e6s2T1+t93aVOT2uqWWzu5x2eTr9OmH3AtOaH/0QqVGjhnne/sYbb4h2hdc5UEgIIICAUwQWLlwoY8eONdnRKvCffvrJPKbXNjtr1qyRnTt3mpqcmTNn+r/M3XbbbTJnzhzzBU/b+WhXeP2sIyGAgHsFwg6A6Abv3l8CSoaAmwTat29vBmvt3Lmz3HfffabmR2t/tF1Pjx49pFu3bvLQQw+Zjh0dO3Y0RW/cuLFoDY+OaK89wO69914pW7asm1goCwIIJBMI+xEY3eCTybGIAAKOEBg6dGiSfGig89JLL4nW/mjbHqtXke6kY5lpW0ZtFxQ4/5K2Dxo+fLgJirRdEKPcJyFlAQFXCoRVA5RSN/h27doZEO0Gb3UNdaUQhUIAgagU0MaPgcGPVQjtdRMY/Fjr9TV37twEP4EgvEfAxQJh1QDRDd7FvwEUDQEEEEAAAQ8KhBUAua0b/JUGR/Lg70GqFll/X/TRg11Jr2f3Ne0qG9dBAAEEEEgbgbACIL20m7rB69gAdv6BTptb58yzaiCijxiSdxlOy9xqew29rp3XTMvycG4x443hgAACCKSlQNgBkGbihhtuMCOnbt++3eRJx9fQEVe1DVDgqKxpmeHUOLeOZRQ46FlqnJNz/Cmg41noSOHx8fG2keTLl88MTGfnNW0rnEcvpAGttschIYAAAmklEHYApDMk6ySop06duiwvOupqNAVAlxWAFQgggAACCCDgKYGweoGpyIABA8zYGD/88IP5Zqbz4OgkhDqS6iuvvOIpNAqLAAIIIIAAAtEtEFYNkE5Op3OVjBgxwsyyrHOm6GMHnRNMx9N4+eWX5c0334xuCXKPAAIIIIAAAp4RCKsGSMfT0Iat2bJlMzAVK1aUJUuWmPd16tQRnRCVhAACCCCAAAIIRItAWAGQBj/VqlWTF154wYyUWr16dfnyyy/lwoULMnv2bIaMj5a7TT4RQAABBBBAwAiE9QhM9/z73/8urVq1koYNG4o2eq5Vq5YZTVV7U82YMQNOBBBAAAEEEEAgagTCDoB0JuUdO3aYLs46jPyqVatk3rx50qRJEyldunTUFJiMIoAAAggggAACYQdASqUDCOqPJh0DSGdVJiGAAAIIIIAAAtEmEFEApD2+VqxYITqQYGAqWrSoVK1aNXAV7xFAAAEEEEAAAccKhB0Avf322zJkyBDTCDp5adq3by9TpkxJvpplBBBAAAEEEEDAkQJhBUAJCQkycuRIM+Dhww8/fNmcSzpsPQkBBBBAAAEEEIgWgbACIJ3bSef7atu2LfPzRMudJZ8IIIAAAgggEFQgrHGAdADETp06yejRo+X06dNBT8YGBBBAAAEEEEAgGgTCqgHSgjz//PNSuXJlMx6QNnjOkOG/sdNf/vIXM01GNBSYPCKAAAIIIJDeAutOnZYNp8/I+bPnZL2vYuEm34wLJHsFwg6AWrdubSY+bdq0qeTPnz9JLqtUqZJkmQUEEEAAAQQQSFng5+Px0uc/2+Sgr3lJgm9GhY7r/5BXy5aSpgWS/m1N+WjWppZAWAHQyZMnZfXq1bJu3Tq56aabUuvanAcBBBBAAAFPCZz1dSrqtXnrZWUevn2X3Jo3j+TMmPGybaxIG4H/PscKcX4d+VlHez5z5kyIvdiEAAIIIIAAAqEELiQkSs6AJiTWvhl9vamPX7xkLfJqg0BYNUCaj6FDh8o999wj/fv3N5OfZs+e3Z+9IkWKmPZB/hW8QQABBBBAAIHLBLJmiJFcvlqeU76aoMAU75tXM3/msP8kBx7K+6sUCFu7T58+cvz4cXn88ccvuxQDIV5GwgoEEEAAAQQuE8jiq/15o1wZeWjDH6Ij6Fmj6I2/oZxkT6Fm6LITsCLVBMIOgPbv3y+JiYkpXjgjzyxTdGElAggggAACyQWq5Mwh3918k3TIllXOXrwoX1S6Ua7Pni35biynsUDYAVDWrFnl2LFjMnHiRNm0aZPExsZKjRo1pFGjRpI5c+Y0zianRwABBBBAwD0CRX0Ti5fxjbF3wtcLjOAnfe5r2AGQ9gK78847RWuCdByggwcPyt69e6VZs2Yybdo00cESSQgggAACCCCAQDQIhNULTAvSo0cPqVevnuzcuVN+//132b17t/z222+yYcMG0YlSSQgggAACCCCAQLQIhBUA6fQXv/zyi7z00ktSokQJUzadAFUfgfXr109++umnaCkv+UQAAQQQQAABBCSsAEinvdAG0CnNA3bq1Cm56GvERUIAAQQQQAABBKJFIKwASNv3NGzYUAYNGiQrV640wdDZs2dlzpw58s4770iTJk2ipbzkEwEEEEAAAQQQCK8GSJ3Gjh1rGkDHxcVJ0aJFpUCBAnLXXXfJLbfcIk899RSUCCCAAAIIIIBA1AiE3QusQoUK8uuvv8oPP/xgGj5rrVD16tWlfv36UVNYMooAAggggAACCKhAyABo+fLlovOAVa5cWf75z3+atj5W4KMH62OwH3/80dQIMSO8ipAQQAABBBBAIBoEQgZAXbt2NWP+6OCHbdq0MVNhpFQopsJISYV1CCCAAAIIIOBUgZAB0KpVq0S7u2s6cOBA0DJoLzESAggggAACCCAQLQIhA6DAKS6y+IbtJiGAAAII/CmQI0cOKNJAwJpVQKdfstNYv+zr3zw7r6nzaOqPnddMg1sWtacMGQBpqbTmZ9asWVKwYEEz7YWOBdS7d2/TBb506dIydOhQadmyZdQCkHEEEEDgagQuXbp0NYdxzBUEEhISzB76arexjndn5zX1enZf8wr8rtp8padTIQOgbdu2Sd26deXo0aPmUZi2A9JG0ToWUK9evWTFihXSunVrWbNmjVSqVMlVcBQGAQQQCCVw7ty5UJvZdpUC58+fN0de8E0SaqexBiI6qK+d19QgT3/svOZV3paoPExrEUOlkAHQyJEjpWTJkrJ582ZzjltvvdUEO1u3bjXr9Remdu3aMmnSJBk2bFio67ANAQQQQAABBBBwjEDIAGjt2rXSqlUrU+ujOb7nnnvk8OHDJvjRZX1mqgMh6gSpJAQQQAABBBBAIFoEQnbfOnTokBQqVMhflvz585sRoP0rfG+0cbTOBxZp0sdqOqji3r17Lzt048aNMm/ePNHrByZdnjt3ruj25CnYMcn3YxkBBBBAAAEEEAgZAClPYCMiq0v8tbJNnz5dnnjiCdFHadqI+q233vKfcvTo0aKP3rQLvo5DtGPHDrNNlzt37iybNm2SgQMHyrRp0654jH8H3iCAAAIIIIAAAgECIR+B6X5aExMfH28OWbp0qekV9vrrr/tPodNjFC9e3L98pTfawv7zzz83QU7ZsmWlU6dOct9998lf//pXM9DiokWLZOrUqSbw0rZFEyZMkMGDB5sgacSIEVKtWjWzf7du3aRFixayZ88eCXbMlfLCdgQQQAABBBDwpkDIAChv3ryycOFC8xPIExgA6fqKFSsGbg75Xsc8+PTTTyVnzpxmP51O4+TJk6br4ZYtW8zI01atU82aNU0XfG2Zv2vXLrNND9LJWHXchN27d5tapKpVq/prqqxjAjOhvdV0Wg8rac81ncyVlPoC1lga2lvQrpQpUybTHs3Oa9pVNq9eRztYkBBAAIG0FAgZAC1ZsiRNrm0FP9r97+233zbjC2lbI20PpEGXlfLkyWMaXetYRHpM4CM43e/IkSNBj7HOoa+///67qXWy1jVt2tQfgFnreE0dAb1H2i7Musepc9bQZ7F+L+y8ZugcsfVaBewci+Va88rxCCAQnQIhA6C0LJKOe6Bd5/Wb3rPPPmsupbVDgR98WvOTPXt2M1Jm4HrdWbfpiKHBjgnMe/fu3UV/rKQB1f79+61FXlNRQINabRRvp2++fPlMDaAGxCR3CGhQGxsb647CUAoEEHCkwBUbQadFrnU06f79+0vu3Lll+PDhpsZAr1O4cGFTq2NdU/+gFStWzIxCrX9UAweL0m3XXXdd0GOsc/CKAAIIIIAAAggkF0iXAOiFF16QG2+8UZ5++mlTg2NlSgdV1FGldVwhreGZOXOmxMXFibbxqFOnjsyYMcPsqu2StEu+/gQ7xjonrwgggAACCCCAQHIB2x+BrV+/XpYtW2Z+pkyZ4s/Pe++9Zxo59+jRQ7SHlzZS1rnGOnbsaPbRqTes7u/aSPr5558367WdULBj/CfnDQIIIIAAAgggECAQMgDSgQe1JuZKSdviaDuMcNJNN91kuq0H21cnVtVGyvq4K7BXjwZDkydPlmPHjl12rWDHBLsG6xFAAAEEEEDA2wIhA6CGDRuKTodxpdS+fXsJrM250v5X2p45c2bRn5RSsEAr1DEpnYd1CCCAAAIIIOBdgZAB0FdffSU6To8mrX3R5ddee80MRrhv3z4zLcX48eOlT58+3hWk5AgggAACCCAQdQIhAyBtqKxJu6o3btzYjKXTrFkzs05Hca5Xr57ptq7TV9SvX9+s5x8EEEAAAQQQQMDpAmH1Ajtz5oyZpqJChQqXlUdHZWb8lctYWIEAAggggAACDhYIKwDSaSe0tmfAgAEmENLyaFA0Z84cefXVV82cXA4uI1lDAAEEEEAAAQSSCIR8BBa450cffSRt27aVIkWKmMlPddoKbR+kIyzrzO4kBBBAAAEEvCig7WMXL14ccdH//e9/y4ULF+TJJ5+M+NhbbrnFTCYe8YEc4BcIOwAqV66c6KSi+rN69WrR8Xd0EMJKlSr5T8YbBBBAAAEEvCagFQLr1q2LuNg6p6W2sb2aY5kqJmLuyw4IOwCyjtQbffToUbnnnntkz549onM/WbO3W/vwigACCCCAgFcEHn/8cdEfUnQJhB0A6QjOzZs3F+3+rkFPq1atZMiQIaZN0Ndff83EhdF138ktAggggAACnhYIqxG0CnXt2tU0hNaZ1EuWLGnQPvnkE1P787//+7+eRqTwCCCAAAIIIBBdAmEFQDp7u7b9GTZsmGn7YxVRu8DrIIizZ8+2VvGKAAIIIIAAAgg4XiCsAEhnY9d2PqdOnbqsQDpVBm2ALmNhBQIIIIAAAgg4WCCsAChLlixy5513mq56K1euNMXRWqGJEyfKmDFjxBod2sHlJGsIIIAAAggggIBfIOxG0OPGjZN27dpJXFycxMTESKNGjcz4BQ888ADjAPk5eYMAAggggAAC0SAQdgB03XXXybJly2TRokWyYcMG0Vqh6tWrm59oKCh5RAABBBBAAAEELIGwA6AmTZrItGnTpEGDBubHOoH2BJs3b555HGat4xUBBBBAAAEEEHCyQMgAaPny5fL999+b/Osw3zrvV7Zs2fzluXTpknzzzTeS0iSp/p14gwACCCCAAAIIOEwgZABUvnx56devn5w7d86095k1a5ZkzJjRX4TMmTNLmTJl5JlnnvGv4w0CCCCAAAIIIOB0gZABUMGCBWXJkiWmDK1btzaPuXLlyuX0MpE/BBBAAAEEEEAgpEDIACjwyBkzZsiZM2dk165dcvHiRbNJH4EdP35cDh06ZLrJB+7PewQQQAABBBBAwKkCYQdAX3zxhTz66KMpDobYvXt3AiCn3mHyhQACCCCAAAKXCYQ1EKIeNWDAALn33nvlhx9+kNy5c5su8e+8844UK1ZMXnnllctOzAoEEEAAAQQQQMCpAmHVAOljLp0FfsSIEVKiRAkpXLiw5MuXT3r37m0aSL/88svy5ptvOrWM5AsBBBBAAAEEEEgiEFYNUI4cOUR7fFld4CtWrOhvHF2nTh3R7vIkBBBAAAEEEEAgWgTCCoA0+KlWrZq88MILcuLECTP685dffmm6xutM8GXLlo2W8pJPBBBwmYCOTL9t27YkpdKhO7QH69KlS83nVODGjRs3msFbtfNGYAp1TOB+vEcAAXcIhPUITIv697//XVq1aiUNGzYUbfRcq1Yt0S7x2hNMe4iREEAAAbsFtm7dKk899ZQ8/vjjZkwyvb72Vu3SpYtUrlxZ9uzZI/plbdSoUWYOw9GjR8vatWvN4K3vv/++vPvuu1KqVKmQx9hdJq6HAAL2CIQdANWuXVt27Ngh58+fN4HPqlWrzLconSKjdOnS9uSWqyAQhoD+nurvp/5u6uNbkjsFpk+fLh9//LHkzZs3SQEnT54s+mi+b9++Zn3Pnj3NY/rY2Fgzl+HUqVMlQ4YMMmnSJJkwYYIMHjxYgh1Tt27dJOdmAQEE3CMQdgCkRdYJUPVHk35r6tatm3nPPwg4RWDBggWycuVKqVevnug3fO29SHKnQPbs2eXDDz8U7Y0aExPjL+TmzZuTDMtRs2ZNWbdunZw+fVqqVq1qgh/dWdfr6Paagh0TGADt3bvXnEP3z5Qpk+j1SakvoMGpJn0NnHkg9a90+RnT45qX54I1qSUQ+LmQ0jkjCoD0GfmKFSvk7NmzSc5VtGhR88GSZCULCKSDwLfffmtqfrRNSK9evdIhB1zSLoE777zTf6nExET/e+2xmidPHv+yvtcBXLNmzZqktkjXHz582OwX7Bj/SXxvtKbo559/Nqvy589vhgIJ3M771BHQQFWT9jQuUqRI6pw0zLPkzJlT9IfkDgHrdylYacIOgN5++20ZMmSIaQSd/GTt27eXKVOmJF/NMgK2C5w8edI0iNVG+8OHDzcT+NqeCS6YrgJaa6BtE62kI9drbU2w9bpfqG3WeQYOHCjHjh0zi1oTbgVP1nZeU0fg6NGj5kTx8fG2GmtQq1/utQ0ZyR0C+v86VDOIsAKghIQEGTlypBnw8OGHH74sQr5SNZM7KClFNAjoY41mzZqZR7RjxoyJhiyTx1QWKFSokBw5csR/Vn1fsmRJU/uzevXqJOt1IFdNwY7x7+x7U6lSpcBF0UdipNQXuHDhgjmpBq7a5tSupLWIGjjbeU27yubV62itb6gUVjd4/YXQLqNt27Y1o0Drc9LAHwKgUMRss1OgefPmpl1I//79RSfwJXlP4LbbbpM5c+aYb/P6uaVd4WvUqCHakWPNmjWyc+dOM5/hzJkzJS4uzgAFO8Z7epQYAe8IhFUDpAMgdurUSbQL6bBhw0JWKXmHjpI6UUC/6Q8dOtR8i7Ma7Dsxn+Qp7QQaN25sxgDq0KGD+aL2wAMP+Mcq69Gjh+m8UaBAAdN7tWPHjiYjoY5Ju5xyZgQQSE+BGF+1339bD4bIyfbt2824Gvo4LLAnhR7yl7/8xUyTEeJwR206cOBAkjYCjspclGemlu8R1N2+msJnn3/etpJoY0mtkQx87GHbxblQmghorbJ2W7+WpIO2atsf7bEVmPQRi3bo0HHMkqdgxyTfT5d5BJaSyrWv0xo6Hcbgs88+Ew1M7Ura4FobzWo7QpI7BPQRmH7ZCZaSfjIE28u3Xh8n6PPypk2bijYWC0xVqlQJXOS9FwV8HxzZP/lQYnwNF7MsWihZv/5Szt3d3osSlNkhAjppc0pJR7bXn5RSsGNS2pd1CCAQ3QJhBUAaEWvjQR1L46abboruEvtyr7UFpFQU8NUK5hj2vPxZlfjnv5l/+1WkQEG5eEeTVLxQyqfS2gL90Rb/JAQQQAABBMIRCCsA0qpiHe3ZLd0DtW0IfyzD+fUIb5/ELf8RyZZdYs7+t/tojK8HR5ZlP0vW1m3DO8k17KWPODQAYvyOa0B02KH6qJ2EAAIIpKVAWAGQZkAblt5zzz2ivWt08tPAUVD12anOuxMtScd6CBwnJFry7dR8Zjh1SrJrz8BkGUw4f05O+R6JpXWy2gDpuCEkdwhoQMvjKHfcS0qBgFMFwg6A+vTpI8ePHzeTDiYvDAMhJhfx1nJCiZLii4gl8fQpf8ETfW0sLtao5V/mDQIIIIAAAk4SCDsA2r9/vwTrMMbjJCfd0nTIi6/tzam/PSG5fe2ARGIk0VcbdOGWODnXqk06ZIZLIoAAAgggcGWBkAHQ8uXLTVdRfby1bNkyM3hYSqfUucDoCZaSjIfW+WZdP/Hy65I490e5UO9/5Fybdh4qPEVFAAEEEIg2gZABUNeuXc2YPxMnTpQ2bdqYR2ApFZBHYCmpeHCd9q7TnyBdjD0oQpERQAABBBwqEDIAWrVqleldo3nXwQODJbqVB5NhPQIIIIAAAgg4USB5x50kedTBwqxRVFu0aOGfXkC7kVs/WjukE6SSEEAAAQQQQACBaBEIWQOkbYC+//57U5bFixfLq6++KjovmJW0K/k333wjFSpUsFbxigACCCCAAAIIOF4gZABUvnx56devn5k3R+fPmTVrVpIBBLWGqEyZMvLMM884vqBkEAEEEEAAAQQQsARCBkAFCxY0syrrzjoXmD7uSmkCQetkvCKAAAIIIIAAAtEgELINUGAB9FGXPgY7f/68Wf3GG2+YnmEff/xx4G68RwABBBBAAAEEHC8QdgD07LPPSsuWLWXv3r2mJujpp582hXviiSdk8uTJji8oGUQAAQQQQAABBCyBsAOgMWPGyOzZs82kqJ9//rlor7Dp06fLsGHDZNKkSdb5eEUAAQQQQAABBBwvEFYAdOTIETlx4oQ0bNjQzAi/YMECadfuz5F+y5UrJ4cOHXJ8QckgAggggAACCCBgCYRsBG3tlD9/fsnhm+pg0aJF5hGYtgNq1qyZmRpDH381atTI2pVXBBBAAAEEEEDA8QJhBUAxMTGibYCaNm0qCQkJ0rt3b4mNjZW2bduKjhU0aNAgxxeUDCKAAAIIIIAAApZAWAGQ7qyNnps3by5nz56VuLg4c3yfPn3M+5w5c1rn4xUBBBBAAAEEEHC8QNgBkJakWrVqSQrEo68kHCwggAACCCCAQJQIhGwE3blzZ5kxY4a/KFu2bEmyrBu0Fuj+++/378MbBBBAAAEE3CBgTQXlhrJQhssFQgZAK1eulD179viPWrhwofTv39+/rG8SExPNT5KVLCCAAAIIIBDFAvPnz5fnnnsuiktA1q8kEDIAutLBbEcAAQQQQMBtAocPHxYd7iV5sw+3ldPr5SEA8vpvAOVHAAEEEEgi8Oabb8qTTz6ZZB0L7hMgAHLfPaVECCCAAAJXKXDs2DHRGqDhw4fL77//Ll988cVVnonDnC4QUS8wpxeG/CGAAAIIIHAtAvny5ZMPPvjAnKJHjx7y4IMPXsvpONbBAlcMgL766ivZvHmzKcKaNWvk4MGDSRpC6wzx5cuXd3ARyRoCCCCAAAKRC4wbNy7ygzgiagRCBkDXX3+9CX52797tL1CxYsXMpKj+Fb43xYsXD1zkPQIIIIAAAggg4GiBkAFQ4BhAji4FmUMAAQQQiHqBmPh4yTbxC1OObJMmSIxv8N3EwoWjvlwUwJkCNIJ25n0hVwgggIC3BHyTbOd6eZhk2LXDlDvGN+1SztEjJebgAW85UFrbBAiAbKPmQggggAACwQSy/LxEEjNlkhjf4Lr+5Jt8O+vc7/yLvEEgNQUIgFJTk3MhgAACCFydwLlzIpcuJTk2xrcUc+5sknUsIJBaAgRAqSXJeRBAAAEErlrg4k2Vktb+/P+ZLtS85arPyYEIhBIgAAqlwzYEEEAAAVsEEkqWkjN33+u/VmLmzHLu1gZysUZN/zreIJCaAiF7gaXmhTgXAggggAACoQQuxtWV0zlziXw9Q87d1VLOt2wdane2IXBNAgRA18THwQgg4FWBzL4aClLqC2QsUNCcNEOhwmKncUxMjGTMmNHWa6a+HmcMFNB7GioRAIXSYRsCCCAQRCBr1qxBtrD6WgSyZMliDtfgx25jDYDsvua1WHFsaIHEwB6FKexKAJQCCqsQQACBKwmcPHnySruw/SoETp8+bY466xsHyE7jHDlyyHnfWER2XvMqeDgkAoErBbM0go4Ak10RQAABBBBAwB0C6RoAaaS9ZMmSyyQ3btwo8+bNk0OHDiXZpstz584V3Z48BTsm+X4sI4AAAggggAAC6RYAafXmiy++KNOnT09yF0aPHi0jR46UVatWSdeuXWXHjh1muy537txZNm3aJAMHDpRp06b5jwt2jH8H3iCAAAIIIIAAAgEC6RIAbdmyRR555BE5ceJEQFZEtm3bJosWLZJx48bJoEGDpEOHDjJhwgSzz1tvvSUjRoyQ3r17m+0fffSReV4b6pgkJ2cBAQQQQAABBBD4f4F0aQStjdyeffZZOXz4sMyePdt/MzQwqlq1qmTI8GdcVrNmTZk1a5ZcvHhRdu3aZbbpzkWLFhVtsLZ7927ZunVrisf4T+p7s3LlSlmxYoV/VcuWLaVAgQL+Zd6knoB2O9TeG7ly+cbysCll0vmDfNe185o2Fc2zl7lS7w3PwlBwBBBINYF0CYCqVKliCrBgwYIkBdm7d6/kzZvXvy5PnjwmSDpw4IDkzJnT/JGzNup+R44ckWDHWPvp67/+9S/55JNP/KuaNGlizudfwZtUE9BARLux6v2yK1ljPdh5TbvK5tXrXEo2J5RXHSg3AgiknUC6BEDBiqNjMAR+8GnNT/bs2c3gVIHr9Xjdli1btsu2WccEXqN79+6iP1bSgGr//v3WIq+pKJDgm7351KlTtvrmy5fP1BpqQExyh4AGtbGxse4oDKVAAAFHCqRLG6BgEoULFza1OtZ2/YNWrFgxKViwoPmjek5nC/7/pNuuu+46CXaMtR+vCCCAAAIIIIBAcgFHBUC1a9eWNWvWyM6dO00Nz8yZMyUuLk60jUedOnVkxowZJv8LFy6U/Pnzm59gxyQvKMsIIIAAAggggIAl4KhHYNrmp0ePHtKtWzfTSLl06dLSsWNHk9devXr5u79rI+nnn3/erA91jFVIXhFAAAEEEEAAgUCBdA2AGjZsKPoTmLSHVtOmTUUfdwX26tFgaPLkyXLs2DHRNh+BKdgxgfvwHgEEEEAAAQQQsATSNQCyMpH8VbtRB5sFOHnwYx0b6hhrH14RQAABBBBAAAEVcFQbIG4JAggggAACCCBghwABkB3KXAMBBBBAAAEEHCVAAOSo20FmEEAAAQQQQMAOAQIgO5S5BgIIIIAAAgg4SoAAyFG3g8wggAACCCCAgB0CBEB2KHMNBBBAAAEEEHCUgCO7wTtKyKOZGTdunOzevTvi0sfHx8vixYvlhRdeiPjY5s2bS926dSM+jgMQQAABBBCIVIAAKFIxj+y/bNkyWbduXcSlzZs3rxw+fFjmzp0b8bGVK1cmAIpYjQMQQAABBK5GgADoatQ8cMxHH33kgVJSRAQQQAABrwrQBsird55yI4AAAggg4GEBAiAP33yKjgACCCCAgFcFCIC8eucpNwIIIIAAAh4WIADy8M2n6AgggAACCHhVgADIq3eeciOAAAIIIOBhAQIgD998io4AAggggIBXBQiAvHrnKTcCCCCAAAIeFiAA8vDNp+gIIIAAAgh4VYAAyKt3nnIjgAACCCDgYQECIA/ffIqOAAIIIICAVwUIgLx65yk3AggggAACHhYgAPLwzafoCCCAAAIIeFWAAMird55yI4AAAggg4GEBAiAP33yKjgACCCCAgFcFCIC8eucpNwIIIIAAAh4WyOThslN0BBBwqcCqVavk3Llz/tLdcMMNUqBAAbO8ceNG2b59u9SsWVMKFSrk30f3/+WXXyQmJkZq164tmTNn9m/jDQIIuE+AAMh995QSIeBpgYsXL8qAAQOkVq1afocHH3zQBECjR4+WtWvXSoUKFeT999+Xd999V0qVKiVnzpyRLl26SOXKlWXPnj3y5ZdfyqhRo0ww5D8JbxBAwFUCBECuup0UBgEEtm3bJiVKlJDXXnstCYauX7RokUydOlUyZMggkyZNkgkTJsjgwYNl8uTJUqdOHenbt685pmfPnrJ8+XKpW7duknOwgAAC7hGgDZB77iUlQQABn8Aff/xhAqDvvvtOpk+fLqdPnzYuW7ZskapVq5rgR1foI7B169aZbZs3bzbLZiHZNmsdrwgg4C4BaoDcdT8pDQKeF9i0aZNoO59q1arJ1q1bZfz48fLJJ5/I3r17JW/evH6fPHnyyOHDh83yvn37RJetpO937dplLZrX7t27m1ohXdD2RPPnz0+ynYXUETh79qw5Uf78+SU2NjZ1ThrmWXLlyiX6Q3KHgD7aDpUIgELpsA0BBKJOQAMV/cmRI4fJuzZu1tqgTJkyyaVLl/zl0bZC2bNnN8sZM2YMus06oF27duYxmS5ny5ZNTpw4YW3iNRUFTp48ac6mf7zsNNbA58KFC0kaz6disThVOggkJiaGvCoBUEgeNrpdYPXq1TJlyhRbi5kvXz7p37+/rdf00sV2795tendZAZA2ctbaH33kpffbSkeOHJFixYqZRe0NpstW0vclS5a0Fs3rXXfdlWRZz0lKfQHrW7vWBJ06dSr1LxDkjDlz5pTz58/bes0gWWF1KglkzZo15JkIgELysNHtAgcPHpQFCxZEXEz9Znrs2LHL/kiGcyK7q/XDyZOb9lm4cKEcOHDANG7W9j8//fST9O7dW7Qr/Ntvvy07d+7LCc8xAAARxUlEQVQ0gc/MmTMlLi7OFP22226TOXPmiL5qDcTSpUvl1VdfdRMLZUEAgWQCBEDJQFj0lsAdd9wh+hNpGjdunIwYMUIWL14c6aHsn8YC7du3Nz3AOnfuLBrgNmnSxNT+aM+vHj16SLdu3UwbntKlS0vHjh1Nbho3bixLliyRDh06mEbSDzzwgJQtWzaNc8rpEUAgPQUIgNJTn2sjgECqC2gD5pdeesn0/tK2PYHV4C1btpSmTZuadh6BjV21fdDw4cNNmxNtF6TLJAQQcLeAJ/+X6zdBknsEdORe/dE/dnakk76GtD/Hn5AEX/u6ZSdOSf18/+09ZMf1uUZ4AlYboOR76wjPwUZ5zp07d/LdWUYAAZcKeDIA0m+EBEHu+Y3Wb+saAGkjxrROZ3zBT7OlK+SgBkCSKI9t2iyPlSop/cuVSetLe+r8V+q94SkMCosAAmki4MkASHsZBHaHTRNZTmqbgPaq0oA2Pj4+za/56Kb/yClf9+mLAd0rP9m1W27NkU0q5fyz23WaZ8IDF9CANvARlQeKTBERQMBmAZ4F2QzO5aJbYK+vm+x/R5L5syz6LWJHwMSb0V1Cco8AAgh4Q4AAyBv3mVKmkkBsliwSk+xcJxISpAgzhydTYREBBBBwtgABkLPvD7lzmMCLZUr6Wv6IPwjS2p9GvkbQNXMzfL7DbhXZQQABBEIKEACF5GEjAkkFivlqgBZVryJVfO19tCZoiC8gGlWO8WKSKrGEAAIIOF+AAMj594gcOkwgl6+7fdMC+SWjr6Fu64IFHJY7soMAAgggEI4AAVA4SuyDAAIIIIAAAq4S8GQ3eFfdQQpzTQK//vqrfPzxxxGfY/PmzWYohccffzziYwsWLChDhw6N+DgOQCCaBC76hovo27dvxFnW+ds0jR07Vr755puIj3/66aelRIkSER/HAd4TIADy3j2nxAECOvHl1q1bA9aE91bHHbr55puv6ljrAz68K7EXAtEpoINZXs3/LS2t/t/S/ydXc/w5hqSIzl+YdMh1jO+XVDu1eCrpTNEMhOieW24NhHjkyBH3FMrjJdGBEGNjYx2tsHfvXkfnj8xFJlCkSBETdOmXIpI7BHTWhwIFgrfTpA2QO+4zpUAAAQQQQACBCAQIgCLAYlcEEEAAAQQQcIcAAZA77iOlQAABBBBAAIEIBAiAIsBiVwQQQAABBBBwhwABkDvuI6VAAAEEEEAAgQgECIAiwGJXBBBAAAEEEHCHAAGQO+4jpUAAAQQQQACBCAQIgCLAYlcEEEAAAQQQcIcAAZA77iOlQAABBBBAAIEIBAiAIsBiVwQQQAABBBBwhwABkDvuI6VAAAEEEEAAgQgEPDkZavbs2SUhISECJnZ1ssDixYvl7Nmz0qBBAydnk7xFIKBzgTk95ciRw+lZJH8RCEyZMkXKlCkjlSpViuAodnWyQKZMoUOc0FudXLJryFvu3Lmv4WgOdZrAt99+K4cOHZJWrVo5LWvkx8UCefPmdXHpvFe09957T+69916pV6+e9wrv0RLzCMyjN55iI4AAAggg4GUBAiAv333KjgACCCCAgEcFYhJ9yaNlp9guEfjPf/4jFy9elBtvvNElJaIYCCBgt8Dq1aulYMGCUrx4cbsvzfXSSYAAKJ3guSwCCCCAAAIIpJ8Aj8DSz54rI4AAAggggEA6CRAApRM8l009AYY0SD1LzoSAVwX4HPHenScA8t49d1WJjx8/Lj169JD169e7qlwUBgEE7BP45ZdfpEuXLkKTWPvMnXAlAiAn3AXycFUCGvz06dNH9HXVqlVXdQ4OQgABbwto8DNs2DA5ePCg7N+/39sYHis9AZDHbrhbimsFP7feeqs89thjsmXLFrcUjXIggIBNAlbw89JLL0nNmjVFe5SSvCNAAOSde+2akmqX9yeffFI0+OnWrZvccMMN8q9//YvpTVxzhykIAmkvsHHjRlPzo8HPzTffLBUqVKAmOe3ZHXUFAiBH3Q4yE46Azu8yaNAgE/zo/jpuR+bMmWX58uXhHM4+CCCAgJQrV05Gjx5tgh/lqFu3rsyZM0fOnTuHjkcECIA8cqPdVszAQQ914sx77rlHvvnmG7cVk/IggEAaCegXKQ2CrKQ1yaVLl5b58+dbq3h1uQABkMtvsJuK984778jcuXNTLNJdd90l//73v0VHcyUhgAACwQS01+iePXtS3Hz//ffLZ599JmfOnElxOyvdJUAA5K776erSaBfVl19+OcUgKEeOHKZH2PDhw+XUqVOudqBwCCBw9QIHDhyQ3r17pxgE3X777VKqVCnRmeFJ7hcgAHL/PXZNCQ8fPmzG6tAPp5Rqgpo2bSpt27Z1TXkpCAIIpK7AhQsXTBuf9u3bBw2Cnn76afMoLHWvzNmcKJDJiZkiTwikJKBjdPTt21fq169veoHpPhr0BKZOnToFLvIeAQQQ8AvoWD/a1ueBBx4QbTuoNUHvvvuuXHfddf598uXLJ/fdd59/mTfuFWAyVPfe26gu2YIFC2TMmDGma3uzZs3k4YcfNs/l8+TJY8q1efNmEwQ9/vjjlwVBUV1wMo8AAqkioMNlvP/++/Ljjz9KbGysPPjgg9KgQQOJj48X63Nk8uTJMmXKlMuCoFTJACdxvACPwBx/i7yXwUOHDsm4ceNk6NChppvqpk2b5IknnpBLly75McqXL2+26eOw77//3r+eNwgggIAKzJ49W44dOybjx4+Xrl27yttvv20+V6zgR/fRRs9a26M1Qfv27dNVJA8JZHzRlzxUXooaBQI6no+OxXH33Xebb2p33HGH6KBlX331lantyZDhz7i9QIECEhcXJ9oAukiRIlFQMrKIAAJ2CUyYMMF8Xtx0001SokQJ0c8R/WKlny068KGVqlSpIvpZol+qsmTJYq3m1QMC1AB54CZHWxH1A2vZsmVy4sQJk3UNePr16yf58+eXDz74IElx9EOrcuXKSdaxgAACCOjnSGDtcKFCheSNN96QqVOnmiEzAoWaNGkiOXPmDFzFew8IEAB54CZHSxG1ulqTPq9v0aKFDBkyRPQ5viYNgvr37y8//fSTWeYfBBBAILmA9vKyhsFo166dmdtLa46tVLRoUdOTdN68edYqXj0sQADk4ZvvlKLv2rVLHnroIenYsaP87W9/MxObdu/e3fTS0C6pp0+fNlnNli2b+XA7e/asU7JOPhBAwCECWtvTpk0b067nlVdeER3pecSIEfLxxx+LNna2kk6bo5MpkxCgFxi/A+kuMGDAADN+T7169UyDxXXr1pkGi/pt7s033zQTFGoV9Zo1a6RixYry6KOPpnueyQACCDhH4OjRo6ZX6MiRI02bQG3UrMGQ/uzevVv0i5S2E9Qu8P/85z/lueeek0qVKjmnAOQkXQQIgNKFnYtaAvrhpO17rG9o+kGmPTMCq6jXr18vP//8s5QsWVIaN25saoas43lFAAEEvvjiCzl58qT/y9HXX39tOk4MHjzY4Jw/f16WLFkiW7duNeOIBc4liJ53BRgI0bv33hEl10HHtO2Pzs2jg5HpcvKkjRn1h4QAAgikJFC8eHHRXl9WSv45or27GjVqZH6sfXhFgDZA/A6kq4D2vPj000/9I7Fqe5+sWbP68zR27FjZsGGDf5k3CCCAQHKBhg0byksvveRfHfg5ol+wdJvWApEQCBQgAArU4H26CGivLyvpB1fu3LnNog5ctmrVKvPoy9rOKwIIIJBcQKe10B5eVrI+RzT46dOnjxQrVowxfiwcXv0CBEB+Ct44QUAbPuuHmQY/2hh61KhRjM/hhBtDHhCIIgH9HNFxxDT40Rneu3TpEkW5J6t2CRAA2SXNdcIS0MHKdEh6gp+wuNgJAQRSEND2hNOmTSP4ScGGVf8VoBfYfy145xAB7cGhs7wzMqtDbgjZQCDKBPQR2Jw5c+See+6JspyTXTsFCIDs1OZaCCCAAAIIIOAIAR6BOeI2kAkEEEAAAQQQsFOAAMhOba6FAAIIIIAAAo4QIAByxG0gEwgggAACCCBgpwABkJ3aXAsBBBBAAAEEHCFAAOSI20AmEEAAAQQQQMBOAQIgO7W5FgIIIIAAAgg4QoDJUB1xG8gEAgiowPbt20XHgfr3v/8tOihmjRo15L777pOMGTMChAACCKSqADVAqcrJyRBA4GoFFi1aJDVr1jTToFy8eFF+++03eeSRR6RZs2YSHx9/taflOAQQQCBFAQZCTJGFlQggYLeAjv6t88B99913/ktv2LBBKleuLGPGjJEePXr41/MGAQQQuFYBHoFdqyDHI4BAqgjo468777wzybkqVqwo7733nsTGxvrXa23Q66+/Lr/88osULlzY1BLdcccd/u1btmyRd955RzR4ypEjh9SrV89MipklSxazz6pVq8z2HTt2yPXXXy/du3eXuLg4//FLly6VDz74QPbs2SOVKlWS/v37S8mSJc12zUuFChVk9+7dMmPGDMmWLZt069ZNGjdu7D+eNwggEB0CPAKLjvtELhFwvcDDDz8sY8eONTN3T58+XY4fP27K/Nhjj0nr1q3N+1OnTkmtWrXMPE9t2rSRTJkySYsWLeTzzz8327du3SpVq1aVI0eOyEMPPWSCleHDh8tzzz1ntu/fv18aNmxoAhcNfLTGqX79+iZY0h1mzpwpt912m7m2ziO1ZMkSufnmm0WDKk1z586Vnj17yieffCIadF26dMnMW7d27VqznX8QQCCKBBJJCCCAgEMEfI+6En01LIm+j9BEX8PnRF/tTaIvGPLn7uWXX070TZKbeOzYsSTrihYtmpiQkJDomwAzsUuXLom+wMS/vXPnzom+oMYs//DDD4m+oCnRFwiZZT1m1KhRievWrTPLZcqUSXzwwQf9x+obXdehQwezrmXLlom+WiH/+fU6BQsWTHz77beTHMMCAgg4X4BHYFEUrJJVBNwu8Oijj4r+aE3Ojz/+KJMmTZK2bduahtG9e/eWFStWmMdhr7zyip9CH0dpzc6uXbtMg2mt4fnpp59k/fr14gtsxBf0+B+h1alTR8qVK2dqhvRxW/PmzUVrnnxBjBw9elS2bdsmviDLf2594wt6TM2PtfKWW26RDBn+rDzX1+LFi8vJkyetzbwigECUCPAILEpuFNlEwM0CGryMHj1azp8/b4pZtmxZ07ZGgxcNiHw1LGa9BinarkcDD+tH2+cMHjzYLK9evVr02K5du8ry5cvN47Dbb7/dT5crVy4TRGkAdfr0aenVq5dpBzR//nzx1SqZ/TSgCUy+2iXzqMta56uBst6aV7roJ+FgAYGoEaAGKGpuFRlFwL0CWbNmNY2NfY+bpF27dkkKWr58edPmR1fq+3nz5smIESP8tTD/+c9/TFsdbRCttUTacFoDJyswWbx4sT+A2bRpk6xcudIEPhr8aINqrQnSxs1TpkwRbSitvdAaNGjgz4O2+6levbp/mTcIIOAOAWqA3HEfKQUCUS2gwcu9995rGi5rDy4dCHHz5s3y0UcfyUsvvWQeU2kBtQGy1hYNHTrUPLLau3evdOrUSb799lsTvGhvMW0AfebMGfG1QBBtTD116lQ5d+6c30fHFtJ12oBZAyCtVdLHYhowaVf7L774QmbPnm3OMX78eFm2bJm0b9/efzxvEEDAJQLOb6ZEDhFAwAsCvsEPEwcOHJjoewRlGkH7PmITixUrlqgNnwPTxIkTE4sUKZLoqzVKzJMnT+Ldd9+duG/fPrPLH3/8YRo8+x6TJRYoUCDR11PLNFD2dVdP9PUqM/u89dZbiTfeeKNpTK0Non29vfzbTpw4YRpRawNsPX+JEiUStWG2lbQRtK9XmrVoXn2jVSf6grQk61hAAAHnCzAQoksCWYqBgJsEtFbm7Nmz4guAghZLGz9rzZE1vk/gjocPHzbrc+fOHbg6yXtf0CT58uUzXeKTbPAtaI3RwYMHxRcAJd/EMgIIuESAAMglN5JiIIAAAggggED4ArQBCt+KPRFAAAEEEEDAJQIEQC65kRQDAQQQQAABBMIXIAAK34o9EUAAAQQQQMAlAgRALrmRFAMBBBBAAAEEwhcgAArfij0RQAABBBBAwCUC/wdqS87C6Oi7bwAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
